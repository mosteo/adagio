<!--//--><script>var PrxLC=new Date(0);var PrxModAtr=0;var PrxInst; if(!PrxInst++) PrxRealOpen=window.open;function PrxOMUp(){PrxLC=new Date();}function PrxNW(){return(this.window);} function PrxOpen(url,nam,atr){ if(PrxLC){  var cdt=new Date();  cdt.setTime(cdt.getTime()-PrxLC.getTime());  if(cdt.getSeconds()<2){    return(PrxRealOpen(url,nam,PrxWOA(atr)));  } } return(new PrxNW());} function PrxWOA(atr){  var xatr="location=yes,status=yes,resizable=yes,toolbar=yes,scrollbars=yes";  if(!PrxModAtr) return(atr);  if(atr){    var hm;    hm=atr.match(/height=[0-9]+/i);    if(hm) xatr+="," + hm;    hm=atr.match(/width=[0-9]+/i);    if(hm) xatr+="," + hm;  }  return(xatr);}window.open=PrxOpen;</script>
<!--//--><script> function NoError(){return(true);} onerror=NoError; </script>
<!--//--><script> function moveTo(){return true;}function resizeTo(){return true;}</script>
<!--//--><script> function status(txt){return(1);} </script>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0053) -->
<HTML xmlns="http://www.w3.org/TR/REC-html40" xmlns:v = 
"urn:schemas-microsoft-com:vml" xmlns:o = 
"urn:schemas-microsoft-com:office:office" xmlns:w = 
"urn:schemas-microsoft-com:office:word" xmlns:st2 = 
"urn:schemas-microsoft-com:office:smarttags" xmlns:st1 = 
"urn:schemas:contacts"><HEAD><TITLE>Gnutela2 Specification Document</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<META content=Word.Document name=ProgId>
<META content="MSHTML 6.00.2800.1141" name=GENERATOR>
<META content="Microsoft Word 10" name=Originator><LINK 
href="gnutella2_draft_files/filelist.xml" rel=File-List><o:SmartTagType 
name="PlaceType" 
namespaceuri="urn:schemas-microsoft-com:office:smarttags"></o:SmartTagType><o:SmartTagType 
name="PlaceName" 
namespaceuri="urn:schemas-microsoft-com:office:smarttags"></o:SmartTagType><o:SmartTagType 
name="place" 
namespaceuri="urn:schemas-microsoft-com:office:smarttags"></o:SmartTagType><o:SmartTagType 
name="PersonName" 
namespaceuri="urn:schemas-microsoft-com:office:smarttags"></o:SmartTagType><o:SmartTagType 
name="Sn" namespaceuri="urn:schemas:contacts"></o:SmartTagType><o:SmartTagType 
name="GivenName" namespaceuri="urn:schemas:contacts"></o:SmartTagType><!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Michael Stokes</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>Michael Stokes</o:LastAuthor>
  <o:Revision>3</o:Revision>
  <o:TotalTime>1067</o:TotalTime>
  <o:Created>2003-03-25T19:27:00Z</o:Created>
  <o:LastSaved>2003-03-25T19:28:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>21543</o:Words>
  <o:Characters>109874</o:Characters>
  <o:Company>Shareaza Pty. Ltd.</o:Company>
  <o:Lines>2616</o:Lines>
  <o:Paragraphs>1877</o:Paragraphs>
  <o:CharactersWithSpaces>129540</o:CharactersWithSpaces>
  <o:Version>10.4219</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>BestFit</w:Zoom>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if !mso]>
<OBJECT id=ieooui classid=clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D></OBJECT>
<STYLE>st2\:* {
	BEHAVIOR: url(#ieooui)
}
st1\:* {
	BEHAVIOR: url(#ieooui)
}
</STYLE>
<![endif]-->
<STYLE>@font-face {
	font-family: Helvetica;
}
@font-face {
	font-family: Courier;
}
@font-face {
	font-family: Tms Rmn;
}
@font-face {
	font-family: Helv;
}
@font-face {
	font-family: New York;
}
@font-face {
	font-family: System;
}
@font-face {
	font-family: Wingdings;
}
@font-face {
	font-family: MS Mincho;
}
@font-face {
	font-family: Batang;
}
@font-face {
	font-family: SimSun;
}
@font-face {
	font-family: PMingLiU;
}
@font-face {
	font-family: MS Gothic;
}
@font-face {
	font-family: Dotum;
}
@font-face {
	font-family: SimHei;
}
@font-face {
	font-family: MingLiU;
}
@font-face {
	font-family: Mincho;
}
@font-face {
	font-family: Gulim;
}
@font-face {
	font-family: Century;
}
@font-face {
	font-family: Angsana New;
}
@font-face {
	font-family: Cordia New;
}
@font-face {
	font-family: Mangal;
}
@font-face {
	font-family: Latha;
}
@font-face {
	font-family: Sylfaen;
}
@font-face {
	font-family: Vrinda;
}
@font-face {
	font-family: Raavi;
}
@font-face {
	font-family: Shruti;
}
@font-face {
	font-family: Sendnya;
}
@font-face {
	font-family: Gautami;
}
@font-face {
	font-family: Tunga;
}
@font-face {
	font-family: Estrangella Edessa;
}
@font-face {
	font-family: Arial Unicode MS;
}
@font-face {
	font-family: Tahoma;
}
@font-face {
	font-family: CG Times;
}
@font-face {
	font-family: Univers;
}
@font-face {
	font-family: Univers Condensed;
}
@font-face {
	font-family: Antique Olive;
}
@font-face {
	font-family: Albertus Medium;
}
@font-face {
	font-family: Albertus Extra Bold;
}
@font-face {
	font-family: Coronet;
}
@font-face {
	font-family: Letter Gothic;
}
@font-face {
	font-family: Marlett;
}
@font-face {
	font-family: Lucida Console;
}
@font-face {
	font-family: Lucida Sans Unicode;
}
@font-face {
	font-family: Verdana;
}
@font-face {
	font-family: Arial Black;
}
@font-face {
	font-family: Comic Sans MS;
}
@font-face {
	font-family: Impact;
}
@font-face {
	font-family: Georgia;
}
@font-face {
	font-family: Franklin Gothic Medium;
}
@font-face {
	font-family: Palatino Linotype;
}
@font-face {
	font-family: Trebuchet MS;
}
@font-face {
	font-family: Webdings;
}
@font-face {
	font-family: Estrangelo Edessa;
}
@font-face {
	font-family: MV Boli;
}
@font-face {
	font-family: Microsoft Sans Serif;
}
@font-face {
	font-family: Arial Narrow;
}
@font-face {
	font-family: Book Antiqua;
}
@font-face {
	font-family: Bookman Old Style;
}
@font-face {
	font-family: Century Gothic;
}
@font-face {
	font-family: Garamond;
}
@font-face {
	font-family: MS Outlook;
}
@font-face {
	font-family: Monotype Corsiva;
}
@font-face {
	font-family: Wingdings 2;
}
@font-face {
	font-family: Wingdings 3;
}
@font-face {
	font-family: MT Extra;
}
@font-face {
	font-family: Calisto MT;
}
@font-face {
	font-family: Castellar;
}
@font-face {
	font-family: Century Schoolbook;
}
@font-face {
	font-family: Copperplate Gothic Bold;
}
@font-face {
	font-family: Copperplate Gothic Light;
}
@font-face {
	font-family: Curlz MT;
}
@font-face {
	font-family: Elephant;
}
@font-face {
	font-family: Engravers MT;
}
@font-face {
	font-family: Eras Bold ITC;
}
@font-face {
	font-family: Eras Demi ITC;
}
@font-face {
	font-family: Eras Light ITC;
}
@font-face {
	font-family: Eras Medium ITC;
}
@font-face {
	font-family: Felix Titling;
}
@font-face {
	font-family: Forte;
}
@font-face {
	font-family: Franklin Gothic Book;
}
@font-face {
	font-family: Franklin Gothic Demi;
}
@font-face {
	font-family: Franklin Gothic Demi Cond;
}
@font-face {
	font-family: Franklin Gothic Heavy;
}
@font-face {
	font-family: Franklin Gothic Medium Cond;
}
@font-face {
	font-family: French Script MT;
}
@font-face {
	font-family: Gill Sans MT;
}
@font-face {
	font-family: Gill Sans MT Condensed;
}
@font-face {
	font-family: Gill Sans Ultra Bold;
}
@font-face {
	font-family: Gill Sans Ultra Bold Condensed;
}
@font-face {
	font-family: Gill Sans MT Ext Condensed Bold;
}
@font-face {
	font-family: Gloucester MT Extra Condensed;
}
@font-face {
	font-family: Goudy Old Style;
}
@font-face {
	font-family: Goudy Stout;
}
@font-face {
	font-family: Haettenschweiler;
}
@font-face {
	font-family: Imprint MT Shadow;
}
@font-face {
	font-family: Lucida Sans;
}
@font-face {
	font-family: Lucida Sans Typewriter;
}
@font-face {
	font-family: Maiandra GD;
}
@font-face {
	font-family: OCR A Extended;
}
@font-face {
	font-family: Palace Script MT;
}
@font-face {
	font-family: Perpetua;
}
@font-face {
	font-family: Perpetua Titling MT;
}
@font-face {
	font-family: Rage Italic;
}
@font-face {
	font-family: Rockwell;
}
@font-face {
	font-family: Rockwell Condensed;
}
@font-face {
	font-family: Rockwell Extra Bold;
}
@font-face {
	font-family: Script MT Bold;
}
@font-face {
	font-family: Tw Cen MT;
}
@font-face {
	font-family: Tw Cen MT Condensed;
}
@font-face {
	font-family: Tw Cen MT Condensed Extra Bold;
}
@font-face {
	font-family: Abadi MT Condensed;
}
@font-face {
	font-family: Silkscreen;
}
@font-face {
	font-family: Silkscreen Expanded;
}
@font-face {
	font-family: Astonished;
}
@font-face {
	font-family: Broken 15;
}
@font-face {
	font-family: DIESEL;
}
@font-face {
	font-family: Dirty Ego;
}
@font-face {
	font-family: Disgusting Behavior;
}
@font-face {
	font-family: Guilty;
}
@font-face {
	font-family: Horse Puke;
}
@font-face {
	font-family: Memory Lapses;
}
@font-face {
	font-family: Misproject;
}
@font-face {
	font-family: Nail Scratch;
}
@font-face {
	font-family: NoMore Typewriters;
}
@font-face {
	font-family: Porcelain;
}
@font-face {
	font-family: Print Error;
}
@font-face {
	font-family: pRint fUck151;
}
@font-face {
	font-family: Rochester;
}
@font-face {
	font-family: Selfish;
}
@font-face {
	font-family: Sydnie;
}
@page Section1 {size: 612.0pt 792.0pt; margin: 72.0pt 90.0pt 72.0pt 90.0pt; mso-header-margin: 35.4pt; mso-footer-margin: 35.4pt; mso-footer: url("gnutella2_draft_files/header.htm") f1; mso-paper-source: 0; }
P.MsoNormal {
	FONT-SIZE: 10pt; MARGIN: 6pt 0cm 3pt; FONT-FAMILY: Verdana; mso-ansi-language: EN-AU; mso-style-parent: ""; mso-pagination: widow-orphan; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: "Times New Roman"
}
LI.MsoNormal {
	FONT-SIZE: 10pt; MARGIN: 6pt 0cm 3pt; FONT-FAMILY: Verdana; mso-ansi-language: EN-AU; mso-style-parent: ""; mso-pagination: widow-orphan; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: "Times New Roman"
}
DIV.MsoNormal {
	FONT-SIZE: 10pt; MARGIN: 6pt 0cm 3pt; FONT-FAMILY: Verdana; mso-ansi-language: EN-AU; mso-style-parent: ""; mso-pagination: widow-orphan; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: "Times New Roman"
}
H1 {
	BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; FONT-SIZE: 16pt; PADDING-BOTTOM: 0cm; MARGIN: 12pt 0cm 3pt; BORDER-LEFT: medium none; COLOR: #6699ff; PADDING-TOP: 0cm; BORDER-BOTTOM: medium none; FONT-FAMILY: Arial; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-style-next: Normal; mso-outline-level: 1; mso-border-bottom-alt: solid #6699FF 1.5pt; mso-padding-alt: 0cm 0cm 0cm 0cm; mso-font-kerning: 16.0pt; mso-prop-change: "Michael Stokes" 20030326T0323
}
H2 {
	FONT-SIZE: 14pt; MARGIN: 12pt 0cm 3pt; COLOR: #4477ee; FONT-STYLE: italic; FONT-FAMILY: Arial; TEXT-DECORATION: none; text-underline: none; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-bidi-font-size: 14.0pt; mso-style-next: Normal; mso-outline-level: 2; mso-prop-change: "Michael Stokes" 20030326T0323; mso-ansi-font-size: 14.0pt
}
H3 {
	FONT-SIZE: 10pt; MARGIN: 12pt 0cm 3pt; COLOR: #3366aa; FONT-FAMILY: Verdana; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-bidi-font-size: 13.0pt; mso-bidi-font-family: Arial; mso-style-next: Normal; mso-outline-level: 3
}
P.MsoToc1 {
	FONT-WEIGHT: bold; FONT-SIZE: 10pt; MARGIN: 6pt 0cm 3pt; FONT-FAMILY: Verdana; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: "Times New Roman"; mso-style-next: Normal; mso-style-update: auto; mso-style-noshow: yes; mso-bidi-font-weight: normal
}
LI.MsoToc1 {
	FONT-WEIGHT: bold; FONT-SIZE: 10pt; MARGIN: 6pt 0cm 3pt; FONT-FAMILY: Verdana; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: "Times New Roman"; mso-style-next: Normal; mso-style-update: auto; mso-style-noshow: yes; mso-bidi-font-weight: normal
}
DIV.MsoToc1 {
	FONT-WEIGHT: bold; FONT-SIZE: 10pt; MARGIN: 6pt 0cm 3pt; FONT-FAMILY: Verdana; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: "Times New Roman"; mso-style-next: Normal; mso-style-update: auto; mso-style-noshow: yes; mso-bidi-font-weight: normal
}
P.MsoToc2 {
	FONT-SIZE: 10pt; MARGIN: 6pt 0cm 3pt 12pt; FONT-FAMILY: Verdana; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: "Times New Roman"; mso-style-next: Normal; mso-style-update: auto; mso-style-noshow: yes
}
LI.MsoToc2 {
	FONT-SIZE: 10pt; MARGIN: 6pt 0cm 3pt 12pt; FONT-FAMILY: Verdana; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: "Times New Roman"; mso-style-next: Normal; mso-style-update: auto; mso-style-noshow: yes
}
DIV.MsoToc2 {
	FONT-SIZE: 10pt; MARGIN: 6pt 0cm 3pt 12pt; FONT-FAMILY: Verdana; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: "Times New Roman"; mso-style-next: Normal; mso-style-update: auto; mso-style-noshow: yes
}
P.MsoToc3 {
	FONT-SIZE: 10pt; MARGIN: 6pt 0cm 3pt 24pt; FONT-FAMILY: Verdana; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: "Times New Roman"; mso-style-next: Normal; mso-style-update: auto; mso-style-noshow: yes
}
LI.MsoToc3 {
	FONT-SIZE: 10pt; MARGIN: 6pt 0cm 3pt 24pt; FONT-FAMILY: Verdana; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: "Times New Roman"; mso-style-next: Normal; mso-style-update: auto; mso-style-noshow: yes
}
DIV.MsoToc3 {
	FONT-SIZE: 10pt; MARGIN: 6pt 0cm 3pt 24pt; FONT-FAMILY: Verdana; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: "Times New Roman"; mso-style-next: Normal; mso-style-update: auto; mso-style-noshow: yes
}
P.MsoHeader {
	FONT-SIZE: 10pt; MARGIN: 6pt 0cm 3pt; FONT-FAMILY: Verdana; tab-stops: center 216.0pt right 432.0pt; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: "Times New Roman"
}
LI.MsoHeader {
	FONT-SIZE: 10pt; MARGIN: 6pt 0cm 3pt; FONT-FAMILY: Verdana; tab-stops: center 216.0pt right 432.0pt; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: "Times New Roman"
}
DIV.MsoHeader {
	FONT-SIZE: 10pt; MARGIN: 6pt 0cm 3pt; FONT-FAMILY: Verdana; tab-stops: center 216.0pt right 432.0pt; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: "Times New Roman"
}
P.MsoFooter {
	FONT-SIZE: 10pt; MARGIN: 6pt 0cm 3pt; FONT-FAMILY: Verdana; tab-stops: center 216.0pt right 432.0pt; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: "Times New Roman"
}
LI.MsoFooter {
	FONT-SIZE: 10pt; MARGIN: 6pt 0cm 3pt; FONT-FAMILY: Verdana; tab-stops: center 216.0pt right 432.0pt; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: "Times New Roman"
}
DIV.MsoFooter {
	FONT-SIZE: 10pt; MARGIN: 6pt 0cm 3pt; FONT-FAMILY: Verdana; tab-stops: center 216.0pt right 432.0pt; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: "Times New Roman"
}
P.MsoTitle {
	FONT-WEIGHT: bold; FONT-SIZE: 16pt; MARGIN: 12pt 0cm 3pt; FONT-FAMILY: Arial; TEXT-ALIGN: center; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; mso-outline-level: 1; mso-font-kerning: 14.0pt
}
LI.MsoTitle {
	FONT-WEIGHT: bold; FONT-SIZE: 16pt; MARGIN: 12pt 0cm 3pt; FONT-FAMILY: Arial; TEXT-ALIGN: center; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; mso-outline-level: 1; mso-font-kerning: 14.0pt
}
DIV.MsoTitle {
	FONT-WEIGHT: bold; FONT-SIZE: 16pt; MARGIN: 12pt 0cm 3pt; FONT-FAMILY: Arial; TEXT-ALIGN: center; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; mso-outline-level: 1; mso-font-kerning: 14.0pt
}
A:link {
	COLOR: blue; TEXT-DECORATION: underline; text-underline: single
}
SPAN.MsoHyperlink {
	COLOR: blue; TEXT-DECORATION: underline; text-underline: single
}
A:visited {
	COLOR: purple; TEXT-DECORATION: underline; text-underline: single
}
SPAN.MsoHyperlinkFollowed {
	COLOR: purple; TEXT-DECORATION: underline; text-underline: single
}
P.Code {
	FONT-SIZE: 10pt; MARGIN: 0cm 0cm 0pt 14.2pt; FONT-FAMILY: "Courier New"; mso-no-proof: yes; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; mso-style-name: Code
}
LI.Code {
	FONT-SIZE: 10pt; MARGIN: 0cm 0cm 0pt 14.2pt; FONT-FAMILY: "Courier New"; mso-no-proof: yes; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; mso-style-name: Code
}
DIV.Code {
	FONT-SIZE: 10pt; MARGIN: 0cm 0cm 0pt 14.2pt; FONT-FAMILY: "Courier New"; mso-no-proof: yes; mso-ansi-language: EN-AU; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; mso-style-name: Code
}
INS {
	TEXT-DECORATION: none; mso-style-type: export-only
}
SPAN.msoIns {
	TEXT-DECORATION: underline; text-underline: single; mso-style-name: ""; mso-style-type: export-only
}
SPAN.msoDel {
	COLOR: red; TEXT-DECORATION: line-through; mso-style-name: ""; mso-style-type: export-only
}
SPAN.SpellE {
	mso-style-name: ""; mso-spl-e: yes
}
SPAN.GramE {
	mso-style-name: ""; mso-gram-e: yes
}
DIV.Section1 {
	page: Section1
}
OL {
	MARGIN-BOTTOM: 0cm
}
UL {
	MARGIN-BOTTOM: 0cm
}
</STYLE>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]--></HEAD>
<BODY lang=EN-US style="tab-interval: 36.0pt" vLink=purple link=blue>
<DIV class=Section1>
<P class=MsoTitle><IMG src="gnutella2_draft_files/gnutella2logo.png"></P>
<P class=MsoTitle><A name=_Toc36412863><SPAN lang=EN-AU>Gnutella2 Specification 
Document</SPAN></A></P>
<P class=MsoTitle><A name=_Toc36412864><SPAN lang=EN-AU>First 
Draft</SPAN></A></P>
<P class=MsoTitle><A name=_Toc36412865><SPAN 
lang=EN-AU>2003-03-26</SPAN></A></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><SPAN lang=EN-AU>Table of Contents</SPAN></H1></DIV>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><!--[if supportFields]><span
lang=EN-AU><span style='mso-element:field-begin'></span><span
style='mso-spacerun:yes'> </span>TOC \o &quot;1-2&quot; \h \z \u <span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
lang=EN-AU><SPAN class=MsoHyperlink><SPAN style="mso-no-proof: yes"><A 
href="#_Toc36412866">Introduction<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412866 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">6</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800360036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412867">Welcome<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412867 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">6</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800360037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412868">What 
is Gnutella2?<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412868 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">7</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800360038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412869">Why is 
it needed?<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412869 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">7</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800360039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412870">What 
About “Old Gnutella”?<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412870 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">7</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800370030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412871">What 
is the Scope of Gnutella2?<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412871 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">8</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800370031000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412872">Gnutella2 
the Standard<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412872 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">8</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800370032000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412873">What 
is the Gnutella2 Standard?<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412873 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">8</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800370033000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412874">Why is 
a Standard Needed?<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412874 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">8</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800370034000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412875">How 
are Standards Enforced?<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412875 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">8</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800370035000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412876">How 
are Applications Tested?<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412876 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">8</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800370036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412877">What 
Standards are Available?<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412877 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">9</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800370037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412878">Common 
Gnutella2 Standard (All Applications)<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412878 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">9</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800370038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412879">Gnutella2 
Standard for File Sharing<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412879 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">9</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800370039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412880">Gnutella2 
the Network Architecture<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412880 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">10</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800380030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412881">Introduction<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412881 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">10</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800380031000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412882">Components<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412882 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">10</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800380032000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412883">Node 
Types and Responsibilities<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412883 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">11</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800380033000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412884">Introduction<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412884 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">11</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800380034000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412885">Leaf 
Nodes<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412885 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">11</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800380035000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412886">Hub 
Nodes<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412886 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">11</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800380036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412887">Hub 
Selection Criteria<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412887 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">11</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800380037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412888">Hub 
Responsibilities<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412888 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">12</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800380038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412889">TCP 
Stream Connection and Handshaking<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412889 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">13</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800380039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412890">Introduction<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412890 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">13</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800390030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412891">Initiation<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412891 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">13</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800390031000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412892">Handshaking<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412892 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">13</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800390032000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412893">Handshake 
Stages<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412893 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">13</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800390033000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412894">Addressing 
Headers<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412894 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">14</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800390034000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412895">Identification<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412895 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">14</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800390035000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412896">Content 
Type (Protocol)<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412896 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">14</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800390036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412897">Node 
State Negotiation<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412897 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">15</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800390037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412898">Hub 
Address Exchange<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412898 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">15</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800390038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412899">Compression 
Negotiation and Encoding<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412899 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">16</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003800390039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412900">Post 
Handshake Communication<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412900 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">16</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900300030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412901">Gnutella2 
UDP Semi-Reliable Transceiver<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412901 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">17</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900300031000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412902">Introduction<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412902 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">17</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900300032000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412903">UDP<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc36412903 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">17</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900300033000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412904">Encoding<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412904 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">17</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900300034000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412905">Fragmentation<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412905 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">19</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900300035000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412906">Transmission 
Process<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412906 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">19</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900300036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412907">Receive 
Process<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412907 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">20</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900300037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412908">Dispatch 
Algorithm<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412908 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">20</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900300038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412909">Parameters<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412909 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">20</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900300039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412910">Performance 
Considerations<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412910 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">21</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900310030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412911">Gnutella2 
Packet Structure<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412911 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">21</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900310031000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412912">Introduction<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412912 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">21</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900310032000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412913">Fictitious 
Visual Example<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412913 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">21</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900310033000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412914">Contents<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412914 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">22</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900310034000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412915">Namespace 
Considerations<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412915 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">22</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900310035000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412916">Framing<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412916 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">23</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900310036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412917">The 
Control Byte<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412917 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">23</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900310037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412918">The 
Length Field<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412918 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">24</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900310038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412919">The 
Type Name Field<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412919 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">24</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900310039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412920">Child 
Packets<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412920 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">24</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900320030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412921">Payload<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412921 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">24</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900320031000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412922">Notes 
on the Control Byte<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412922 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">24</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900320032000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412923">Simple 
Packet Decoder in C<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412923 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">25</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900320033000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412924">Datatypes<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412924 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">25</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900320034000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412925">Introduction<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412925 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">25</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900320035000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412926">Multi-Byte 
Integers<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412926 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">25</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900320036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412927">Network/Node 
Addresses<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412927 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">25</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900320037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412928">GUIDs<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412928 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">26</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900320038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412929">Strings<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412929 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">26</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900320039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412930">Basic 
Network Maintenance<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412930 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">26</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900330030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412931">Introduction<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412931 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">26</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900330031000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412932">/PI - 
(Ping)<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412932 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">26</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900330032000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412933">/PI/RELAY 
– Relayed Ping Marker<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412933 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">27</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900330033000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412934">/PI/UDP 
– Ping Response Address<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412934 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">28</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900330034000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412935">/PO – 
Pong<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412935 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">28</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900330035000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412936">/PO/RELAY 
– Relayed Pong Marker<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412936 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">29</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900330036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412937">/LNI – 
Local Node Information<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412937 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">29</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900330037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412938">/LNI/NA 
– Node Address<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412938 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">30</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900330038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412939">/LNI/GU 
– GUID<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412939 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">30</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900330039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412940">/LNI/V 
– Vendor Code<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412940 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">31</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900340030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412941">/LNI/LS 
– Library Statistics<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412941 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">31</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900340031000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412942">/LNI/HS 
– Hub Status<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412942 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">31</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900340032000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412943">/KHL – 
Known Hub List<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412943 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">32</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900340033000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412944">/KHL/TS 
– Timestamp<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412944 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">32</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900340034000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412945">/KHL/NH 
– Neighbouring Hub<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412945 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">33</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900340035000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412946">/KHL/NH/GU 
– GUID<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412946 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">33</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900340036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412947">/KHL/NH/V 
– Vendor Code<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412947 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">34</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900340037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412948">/KHL/NH/LS 
– Library Statistics<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412948 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">34</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900340038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412949">/KHL/NH/HS 
– Hub Status<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412949 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">34</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900340039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412950">/KHL/CH 
– Cached Hub<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412950 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">35</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900350030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412951">/KHL/CH/GU 
– GUID<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412951 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">35</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900350031000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412952">/KHL/CH/V 
– Vendor Code<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412952 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">36</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900350032000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412953">/KHL/CH/LS 
– Library Statistics<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412953 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">36</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900350033000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412954">/KHL/CH/HS 
– Hub Status<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412954 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">36</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900350034000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412955">Known 
Hub Cache and Hub Cluster Cache<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412955 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">37</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900350035000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412956">Introduction<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412956 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">37</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900350036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412957">The 
Known Hub Cache<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412957 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">37</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900350037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412958">The 
Hub Cluster Cache<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412958 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">37</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900350038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412959">Node 
Route Cache and Addressed Packet Forwarding<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412959 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">38</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900350039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412960">Introduction<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412960 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">38</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900360030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412961">Data<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc36412961 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">38</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900360031000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412962">Performance<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412962 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">38</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900360032000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412963">Applications<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412963 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">38</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900360033000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412964">Addressed 
Packet Forwarding<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412964 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">38</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900360034000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412965">Reverse 
Connection (Push) Requests<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412965 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">39</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900360035000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412966">/PUSH 
– Push / Connect Back Request<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412966 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">39</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900360036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412967">Push 
Handshaking<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412967 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">40</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900360037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412968">Query 
Hash Tables, Superset Table and Exchange<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412968 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">40</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900360038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412969">Introduction<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412969 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">40</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900360039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412970">Table 
Properties<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412970 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">41</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900370030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412971">Table 
Content<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412971 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">41</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900370031000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412972">Word 
Hashing<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412972 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">41</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900370032000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412973">URNs – 
A Special Case<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412973 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">42</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900370033000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412974">Word 
Prefix Extensions<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412974 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">42</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900370034000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412975">Table 
Exchange<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412975 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">42</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900370035000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412976">/QHT – 
Query Hash Table<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412976 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">43</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900370036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412977">Table 
Access<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412977 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">44</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900370037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412978">The 
Aggregate or Superset Table<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412978 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">44</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900370038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412979">Query 
Filtering<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412979 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">45</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900370039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412980">Gnutella2 
Object Search Mechanism<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">.. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412980 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">45</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900380030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412981">Introduction<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412981 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">45</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900380031000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412982">Model<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412982 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">45</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900380032000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412983">Search 
Process Walkthrough<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412983 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">46</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900380033000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412984">Search 
Security<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412984 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">47</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900380034000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412985">Introduction<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412985 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">47</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900380035000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412986">/QKR – 
Query Key Request<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412986 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">48</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900380036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412987">/QKR/RNA 
– Requesting Node Address<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412987 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">48</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900380037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412988">/QKA – 
Query Key Answer<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412988 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">49</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900380038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412989">/QKA/QK 
– Query Key<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412989 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">49</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900380039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412990">/QKA/SNA 
– Sending Node Address<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412990 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">49</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900390030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412991">/QKA/QNA 
– Queried Node Address<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412991 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">50</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900390031000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412992">Search 
Descriptor<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412992 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">50</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900390032000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412993">Introduction<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412993 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">50</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900390033000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412994">/Q2 – 
Gnutella2 Query<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412994 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">50</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900390034000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412995">/Q2/UDP 
– Return Address and Authentication<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412995 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">51</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900390035000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412996">/Q2/URN 
– Universal Resource Name<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412996 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">52</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900390036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412997">/Q2/DN 
– Descriptive Name (Generic) Criteria<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412997 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">53</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900390037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412998">/Q2/MD 
– Metadata Criteria<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412998 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">53</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900390038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36412999">/Q2/SZR 
– Size Restriction Criteria<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36412999 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">53</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310032003900390039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413000">/Q2/I 
– Interest<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413000 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">54</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000300030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413001">Search 
Acknowledgement<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413001 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">54</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000300031000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413002">Introduction<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413002 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">54</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000300032000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413003">Contents<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413003 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">55</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000300033000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413004">/QA – 
Query Acknowledgement<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413004 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">55</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000300034000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413005">/QA/TS 
– Timestamp<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413005 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">56</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000300035000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413006">/QA/D 
– Done Hub<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413006 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">56</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000300036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413007">/QA/S 
– Search Hub<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413007 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">56</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000300037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413008">/QA/RA 
– Retry After<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413008 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">57</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000300038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413009">/QA/FR 
– From Address<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413009 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">57</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000300039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413010">Search 
Results<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413010 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">58</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000310030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413011">Introduction<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413011 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">58</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000310031000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413012">/QH2 – 
Query Hit<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413012 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">58</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000310032000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413013">/QH2/GU 
– Node GUID<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413013 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">59</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000310033000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413014">/QH2/NA 
– Node Address<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413014 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">59</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000310034000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413015">/QH2/NH 
– Neighbouring Hub<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413015 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">60</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000310035000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413016">/QH2/V 
– Vendor Code<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413016 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">60</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000310036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413017">/QH2/BUP 
– Browse User Profile Tag<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413017 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">60</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000310037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413018">/QH2/PCH 
– Peer Chat Tag<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413018 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">61</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000310038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413019">/QH2/HG 
– Hit Group Descriptor<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413019 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">61</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000310039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413020">/QH2/HG/SS 
– Server State<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413020 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">62</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000320030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413021">/QH2/H 
– Hit Descriptor<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413021 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">62</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000320031000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413022">/QH2/H/URN 
– Universal Resource Name<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413022 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">63</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000320032000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413023">/QH2/H/URL 
– Universal Resource Location<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413023 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">63</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000320033000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413024">/QH2/H/DN 
– Descriptive Name (Generic) Criteria<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413024 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">64</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000320034000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413025">/QH2/H/MD 
– Metadata<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413025 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">64</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000320035000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413026">/QH2/H/SZ 
– Object Size<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413026 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">65</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000320036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413027">/QH2/H/G 
– Group Identifier<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413027 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">65</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000320037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413028">/QH2/H/ID 
– Object Identifier<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413028 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">66</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000320038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413029">/QH2/H/CSC 
– Cached Source Count<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413029 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">66</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000320039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413030">/QH2/H/PART 
– Partial Content Tag<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413030 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">66</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000330030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413031">/QH2/H/COM 
– User Comment<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413031 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">67</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000330031000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413032">/QH2/H/PVU 
– Preview URL<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413032 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">67</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000330032000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413033">/QH2/MD 
– Unified Metadata Block<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413033 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">68</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000330033000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413034">/QH2/UPRO 
– User Profile<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413034 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">68</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000330034000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413035">/QH2/UPRO/NICK 
– Nick/Screen Name<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413035 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">69</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000330035000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413036">Simple 
Query Language and Metadata<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413036 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">69</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000330036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413037">Introduction<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413037 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">69</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000330037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413038">Query 
Language Definition<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413038 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">69</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000330038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413039">Examples<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted"> </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413039 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">70</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000330039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413040">Metadata 
Searching<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413040 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">70</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000340030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413041">Numeric 
Range Matching<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413041 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">71</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000340031000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413042">Generic 
Matching on Metadata<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413042 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">71</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000340032000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413043">HTTP/1.1 
Server for Uploading<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413043 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">71</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000340033000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413044">HTTP/1.1 
Client for Downloading<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413044 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">71</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000340034000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc1 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413045">User 
Profile Challenge and Delivery<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413045 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">71</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000340035000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413046">Introduction<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413046 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">71</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000340036000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413047">gProfile 
Schema<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413047 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">71</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000340037000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413048">Profile 
Challenge and Response/Delivery<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413048 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">72</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000340038000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413049">/UPROC 
– User Profile Challenge<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413049 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">72</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000340039000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoToc2 style="tab-stops: right dotted 431.5pt"><SPAN 
class=MsoHyperlink><SPAN lang=EN-AU style="mso-no-proof: yes"><A 
href="#_Toc36413050">/UPROD 
– User Profile Delivery<SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><SPAN 
style="mso-tab-count: 1 dotted">. </SPAN></SPAN><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc36413050 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none">72</SPAN><SPAN 
style="DISPLAY: none; COLOR: windowtext; TEXT-DECORATION: none; mso-hide: screen; text-underline: none"><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000D0000005F0054006F006300330036003400310033003000350030000000</w:data>
</xml><![endif]--></SPAN><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></A></SPAN></SPAN><SPAN 
style="mso-no-proof: yes; mso-ansi-language: EN-US"><o:p></o:p></SPAN></P>
<P class=MsoNormal><!--[if supportFields]><span lang=EN-AU><span
style='mso-element:field-end'></span></span><![endif]--><SPAN 
lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36412866><SPAN lang=EN-AU>Introduction</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H1></DIV>
<H2><A name=_Toc36412867><SPAN lang=EN-AU>Welcome</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>This is a specification and standard 
document for “Gnutella2”. It is currently a "first public draft". Comments and 
revisions are welcome. This document covers the Gnutella2 architecture and 
standard only: it does not deal with Gnutella1 or other related standards, 
technologies and protocols that are well documented 
elsewhere.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412868><SPAN lang=EN-AU>What is Gnutella2?</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Gnutella2 is a modern and efficient 
peer-to-peer network standard and architecture designed to provide a solid 
foundation for distributed global services such as person to person 
communication, data location and transfer and other future 
services.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412869><SPAN lang=EN-AU>Why is it needed?</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Peer to peer technologies have become 
mainstream over recent years, and there are already a significant number of P2P 
networks in various stages of development and operation.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>How does yet another network 
help?<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Gnutella2 is unique amongst the currently 
operating peer to peer networks in several important ways:<o:p></o:p></SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l12 level1 lfo1"><SPAN 
  lang=EN-AU>Many of the most successful networks are “closed”, owned by a 
  single entity with restrictions or fees constituting a barrier to 
  participation.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>This is not a 
  viable model for an open, general purpose network.<SPAN 
  style="mso-spacerun: yes">&nbsp; </SPAN>Gnutella2 is an open architecture 
  where anyone is welcome to participate and contribute.<SPAN 
  style="mso-spacerun: yes">&nbsp; </SPAN>The network has been designed to allow 
  such diversity without the need for messy hacks or compromises in 
  integrity.<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l12 level1 lfo1"><SPAN lang=EN-AU>The 
  majority of networks are devoted to a single purpose, often the sharing of 
  files.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>This is certainly a 
  popular application for peer to peer technology, but it is by no means the 
  only application.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Gnutella2 is 
  designed as a general purpose network which can be used as a solid foundation 
  for any number of different peer to peer applications – vanilla file sharing, 
  communications tools or other ideas which are yet to be 
  conceived.<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l12 level1 lfo1"><SPAN 
  lang=EN-AU>Some peer to peer networks have been developed with similar general 
  purpose goals, however they have been unable to compete in the most popular 
  application of the day, which is file sharing.<SPAN 
  style="mso-spacerun: yes">&nbsp; </SPAN>For a general purpose network to 
  succeed, it must be able to compete with purpose-specific networks in the most 
  popular purpose.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Gnutella2 is not 
  only able to compete with the current popular file sharing specific networks, 
  it outperforms them.<o:p></o:p></SPAN> </LI></UL>
<H2><A name=_Toc36412870><SPAN lang=EN-AU>What </SPAN></A><SPAN 
class=GramE><SPAN style="mso-bookmark: _Toc36412870"><SPAN 
lang=EN-AU>About</SPAN></SPAN></SPAN><SPAN 
style="mso-bookmark: _Toc36412870"><SPAN lang=EN-AU> “Old 
Gnutella”?</SPAN></SPAN><SPAN lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The original “Gnutella” was created several 
years ago as a very simple, single vendor file-sharing specific network.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Its simplicity made it a popular 
platform for file sharing application developers; however this simplicity also 
critically limited its effectiveness.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>As a result, competing file-sharing specific networks slowly but surely 
took over as the tools of choice as Gnutella users became frustrated with poor 
performance and turned elsewhere.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The original Gnutella[1] network was 
designed for a very limited purpose and, despite many changes over the years, 
remains limited today.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Efforts to 
make it a better file sharing network continue with mixed 
success.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Gnutella2 shares the “Gnutella” name, 
striving to create the network that Gnutella should have been from the 
beginning.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>It shares the adopted 
ideals of openness and cooperation, but offers a fresh start that was sorely 
needed.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The crippling limitations 
of the old network have been left behind and replaced with <SPAN class=GramE>an 
entirely</SPAN> new network architecture ready to grow and develop through the 
creative efforts of many.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412871><SPAN lang=EN-AU>What is the Scope of 
Gnutella2?</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The single name “Gnutella2” really refers to 
two separate components: Gnutella2 the Standard and Gnutella2 the 
Network.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The Gnutella2 Network is perhaps the most 
easily recognised component.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>It is 
a new high-performance peer to peer network architecture upon which a variety of 
distributed applications can be built, such as file sharing applications, 
communication tools, etc.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The Gnutella2 Standard is a set of 
requirements for building applications which operate on the Gnutella2 network in 
different capacities.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>It specifies 
the minimum compliance level required to be recognised as a Gnutella2-compatible 
application.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Compliance with a 
Gnutella2 Standard ensures participating applications provide a minimum 
acceptable level of service to other network participants.<o:p></o:p></SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36412872><SPAN lang=EN-AU>Gnutella2 the Standard</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H1></DIV>
<H2><A name=_Toc36412873><SPAN lang=EN-AU>What is the Gnutella2 
Standard?</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The Gnutella2 Standard is a set of 
requirements for building applications which operate with the Gnutella2 network 
in different capacities.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>For 
example, the Gnutella2 Standard for File Sharing specifies a set of features and 
behaviours which must be available in any Gnutella2-connected file-sharing 
product offered to the public.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412874><SPAN lang=EN-AU>Why is a Standard 
Needed?</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>As an open, general purpose platform, 
Gnutella2 networks must be able to operate with a diverse family of different 
implementing applications.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Every 
effort has been made to limit the ill-effects a non-compliant application can 
cause (deliberately or accidentally), however when it comes to critical features 
such as common URN schemes and character encodings, minimum standards help to 
ensure a favourable baseline user experience.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412875><SPAN lang=EN-AU>How are Standards 
Enforced?</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The open and transparent nature of the 
Gnutella2 architecture makes technical enforcement difficult, so a more viable 
(and hopefully, more productive) social scheme has instead been adopted.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Only applications meeting the 
appropriate Gnutella2 Standard may be marked as “Gnutella2-compliant”.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Websites containing information about 
Gnutella2 (such as gnutella2.com) are encouraged to list only compliant 
applications, and application developers are encouraged to deny communications 
with known non-compliant applications.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>Applications which do not comply with the standard or are still in the 
development process should never be made available to the public, however 
private testing is always encouraged.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412876><SPAN lang=EN-AU>How are Applications 
Tested?</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Ultimately it is the responsibility of the 
developer to ensure their own application complies with the relevant standards, 
both with respect to Gnutella2 and any other functionality they may be 
including.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>However as an 
inter-dependent community, developers of Gnutella2-compliant applications are 
encouraged to take an interest in other Gnutella2 applications, and where 
possible, examine them for compliance.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>Similarly, new developers are strongly encouraged to seek assistance from 
other developers in verifying their work.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>This need not compromise competitive advantage – if the application is 
sensitive, the important compliance testing phase can be performed in the days 
prior to release.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412877><SPAN lang=EN-AU>What Standards are 
Available?</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>At the current time, only one Gnutella2 
standard has been published: the Gnutella2 standard for File Sharing 
Applications, detailed below.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>Additional standards for other application classes will be published in 
the future as required.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Developers of new application classes are 
operating in somewhat untried territory, and should review the existing 
published standards for best practices which can be borrowed.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>In particular, the basic components of 
the Gnutella2 network architecture should always be implemented in 
full.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412878><SPAN lang=EN-AU>Common Gnutella2 Standard (All 
Applications)</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>All applications making use of Gnutella2 
technology for any application class MUST IMPLEMENT the following core 
features:<o:p></o:p></SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l19 level1 lfo2"><SPAN 
  lang=EN-AU>Bidirectional TCP stream connections<BR>(stream compression 
  OPTIONAL)<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l19 level1 lfo2"><SPAN 
  lang=EN-AU>Bidirectional reliable UDP protocol<BR>(Gnutella2 reliability layer 
  and stateless compression REQUIRED)<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l19 level1 lfo2"><SPAN 
  lang=EN-AU>HTTP-style link negotiation, exchanging at least the required 
  headers<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l19 level1 lfo2"><SPAN 
  lang=EN-AU>Gnutella2 protocol support, graceful handling of unknown 
  trees<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l19 level1 lfo2"><SPAN 
  lang=EN-AU>Localised, UTF-8 and UNICODE decode REQUIRED, encoding to each 
  optional<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l19 level1 lfo2"><SPAN 
  lang=EN-AU>Operation in LEAF mode, additional node states 
  OPTIONAL<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l19 level1 lfo2"><SPAN 
  lang=EN-AU>Basic link handshaking and maintenance functionality 
  (PI/PO/LNI/KHL)<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l19 level1 lfo2"><SPAN 
  lang=EN-AU>Global node addressing scheme and routing maintenance, addressing 
  children (TO)<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l19 level1 lfo2"><SPAN 
  lang=EN-AU>Reverse (PUSH) connection response (connecting 
  out)<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l19 level1 lfo2"><SPAN 
  lang=EN-AU>HTTP/1.1 client and server for peer to peer 
  transactions<o:p></o:p></SPAN> </LI></UL>
<P class=MsoNormal><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<H2><A name=_Toc36412879><SPAN lang=EN-AU>Gnutella2 Standard for File 
Sharing</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Applications making use of Gnutella2 
technology for file sharing MUST IMPLEMENT the following 
features:<o:p></o:p></SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l24 level1 lfo3"><SPAN lang=EN-AU>All 
  of the COMMON features listed in the previous section<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l24 level1 lfo3"><SPAN 
  lang=EN-AU>Operation in LEAF mode, additional node states 
  OPTIONAL<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l24 level1 lfo3"><SPAN 
  lang=EN-AU>Some form of bandwidth management scheme to keep network and 
  transfer bandwidth below 95% of the user’s link capacity – be it manually 
  configured or some automatic scheme (very important to avoid flooding local 
  connection)<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l24 level1 lfo3"><SPAN 
  lang=EN-AU>SHA1 and TIGER ROOT URNs for all shared objects<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l24 level1 lfo3"><SPAN lang=EN-AU>XML 
  metadata using existing schemas where appropriate (manual entry and peer 
  acquired at minimum, automatic local collection highly recommended, service 
  lookup optional)<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l24 level1 lfo3"><SPAN 
  lang=EN-AU>Universal 1-bit query hash filter, at least 2^20 length, 
  intelligent density management scheme (superset combination required if 
  supporting hub mode)<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l24 level1 lfo3"><SPAN 
  lang=EN-AU>Gnutella2 object search mechanism, all client responsibilities and 
  if supporting hub mode, server responsibilities too<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l24 level1 lfo3"><SPAN 
  lang=EN-AU>Local search processing including simple query language (Boolean 
  operations, quoted search terms, numeric range searches, interest flagging 
  (I), local rule-based metadata searching)<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l24 level1 lfo3"><SPAN 
  lang=EN-AU>Extensible hit format (URN/DN/MD/URL are REQUIRED, all other 
  extensions OPTIONAL)<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l24 level1 lfo3"><SPAN 
  lang=EN-AU>HTTP/1.1 based upload system, URN based requesting, partial content 
  requests, active queuing, partial file uploading, timestamp protected 
  alternate source cache and exchange<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l24 level1 lfo3"><SPAN 
  lang=EN-AU>Tiger Tree volume calculation on shared files, caching on 
  downloads, exchange via DIME.<SPAN style="mso-spacerun: yes">&nbsp; 
  </SPAN>Local corruption detection OPTIONAL but recommended.<o:p></o:p></SPAN> 
  </LI></UL>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36412880><SPAN lang=EN-AU>Gnutella2 the Network 
Architecture</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H1></DIV>
<H2><A name=_Toc36412881><SPAN lang=EN-AU>Introduction</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The remainder of this document is concerned 
with the Gnutella2 network architecture, which is the most substantial part of 
the Gnutella2 initiative and forms the core of the Gnutella2 
standard.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412882><SPAN lang=EN-AU>Components</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The Gnutella2 network architecture consists 
of several key components:<o:p></o:p></SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l46 level1 lfo4"><SPAN 
  lang=EN-AU>Node types and responsibilities for self-organising network 
  topology</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l46 level1 lfo4"><SPAN lang=EN-AU>TCP 
  stream connection handshake negotiation and compression 
  encoding<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l46 level1 lfo4"><SPAN lang=EN-AU>UDP 
  reliable/semi-reliable transceiver stack and encapsulation 
  protocol<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l46 level1 lfo4"><SPAN 
  lang=EN-AU>Gnutella2 common tree packet structure (basic 
  protocol)<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l46 level1 lfo4"><SPAN 
  lang=EN-AU>Basic network maintenance packet types<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l46 level1 lfo4"><SPAN 
  lang=EN-AU>Known hub cache and hub cluster cache</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l46 level1 lfo4"><SPAN 
  lang=EN-AU>Node route cache and addressed packet forwarding<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l46 level1 lfo4"><SPAN 
  lang=EN-AU>Query hash table, superset table and exchange packet 
  types<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l46 level1 lfo4"><SPAN 
  lang=EN-AU>Gnutella2 object search mechanism, client and server roles, 
  forwarding rules, filtering rules, security<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l46 level1 lfo4"><SPAN 
  lang=EN-AU>Local search responder with simple query language and 
  metadata<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l46 level1 lfo4"><SPAN 
  lang=EN-AU>HTTP/1.1 server for upload queuing and servicing<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l46 level1 lfo4"><SPAN 
  lang=EN-AU>HTTP/1.1 client for download scheduling and 
  transfer<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l46 level1 lfo4"><SPAN 
  lang=EN-AU>User profile challenge and delivery packet types<o:p></o:p></SPAN> 
  </LI></UL>
<P class=MsoNormal><SPAN lang=EN-AU>Note that a typical peer to peer application 
utilising Gnutella2 will have many additional components related to its core 
function.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>This list covers only 
components with an obvious network interaction, and should not be used as an 
exhaustive design guide.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>A typical 
file sharing application may have in excess of 120 components at the core 
level.<o:p></o:p></SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36412883><SPAN lang=EN-AU>Node Types and 
Responsibilities</SPAN></A></H1></DIV>
<H2><A name=_Toc36412884><SPAN lang=EN-AU>Introduction</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The Gnutella2 network is an ad-hoc, 
self-organising collection of interconnected nodes cooperating to enable 
productive distributed activities.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Not all of the nodes participating in the 
system are equal: there are two primary node types, “hubs” and “leaves”.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>The goal is to maximise the number of 
leaves and minimise the number of hubs, however due to the limited nature of 
resources the maximum viable ratio of leaves to hubs is limited.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>This quantity is known as the “leaf 
density”.</SPAN></P>
<H2><A name=_Toc36412885><SPAN lang=EN-AU>Leaf Nodes</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Leaf nodes are the most common node type on 
the network – they have no special responsibilities and do not form a working 
part of the network infrastructure.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>Nodes with limited resources must operate as leaf nodes: this includes 
limited bandwidth, CPU or RAM, low or unpredictable expected uptime, and 
inability to accept inbound TCP or UDP.</SPAN></P>
<H2><A name=_Toc36412886><SPAN lang=EN-AU>Hub Nodes</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Hub nodes on the other hand form an 
important and active part of the network infrastructure, organising surrounding 
nodes, filtering and directing traffic over several media types.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Hub nodes devote substantial resources 
to the network, and as a result their capacity to participate in higher level 
network functions is limited. Only the most capable nodes are selected to act as 
hubs, based upon the criteria in the following section.</SPAN></P>
<H2><A name=_Toc36412887><SPAN lang=EN-AU>Hub Selection Criteria</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Hubs are selected based on the following 
internal criteria:<o:p></o:p></SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l18 level1 lfo15"><SPAN 
  lang=EN-AU>Suitable operating system (able to support &gt; 100 sockets)</SPAN> 

  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l18 level1 lfo15"><SPAN 
  lang=EN-AU>Suitably high CPU and RAM available</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l18 level1 lfo15"><SPAN 
  lang=EN-AU>Long uptime (many hours, at least two), possibly considering 
  historical uptime</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l18 level1 lfo15"><SPAN 
  lang=EN-AU>Adequate bandwidth, primarily inbound bandwidth</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l18 level1 lfo15"><SPAN 
  lang=EN-AU>Ability to accept inbound TCP and UDP</SPAN> </LI></UL>
<P class=MsoNormal><SPAN lang=EN-AU>In addition to these internal factors, hubs 
must also consider the network’s need for additional hubs.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Without a central point of authority the 
need for additional hubs cannot be determined with absolute certainty; however 
it can be approximated by examining the state of nearby nodes and specifically 
the state of hubs in the local hub cluster.</SPAN></P>
<H2><A name=_Toc36412888><SPAN lang=EN-AU>Hub Responsibilities</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Nodes operating as Gnutella2 hubs have a set 
of responsibilities to meet.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Hubs 
are highly interconnected, forming a “hub network” or “hub web”, with each hub 
maintaining a connection to 5-30 other “neighbouring” hubs.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>The number of hub interconnections must 
scale up with the overall size of the network.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Each hub also accepts connections from a 
large collection of leaf nodes, typically 300-500 depending on available 
resources.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Leaf nodes are 
considered to be the “edge” of the network.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>In practice leaves simultaneously 
connect to three hubs, however from the point of view of the hubs each leaf is 
considered a dead end.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The group of hubs within the hub network 
spanning the local hub and its neighbours is termed the “hub cluster”, and is an 
important grouping.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Hub clusters 
maintain constant communication with each other, sharing information about 
network load and statistics, exchanging cache entries and filtering tables.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>The hub cluster is also the smallest 
searchable unit of the network as far as a search client is 
concerned.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Hub responsibilities include:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l54 level1 lfo16"><SPAN 
  lang=EN-AU>Maintaining up to date information about other hubs in the cluster, 
  and their neighbouring hubs, providing updates to neighbours</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l54 level1 lfo16"><SPAN 
  lang=EN-AU>Maintaining a node routing table mapping node GUIDs to shortest 
  route local TCP connections and UDP endpoints</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l54 level1 lfo16"><SPAN 
  lang=EN-AU>Maintaining query hash tables for each connection, including both 
  leaves and hubs so that queries can be executed intelligently</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l54 level1 lfo16"><SPAN 
  lang=EN-AU>Maintaining a superset query hash table including local content and 
  every connected leaf (not hub)’s supplied tables, to supply to neighbouring 
  hubs</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l54 level1 lfo16"><SPAN 
  lang=EN-AU>Monitoring the status of local connections and deciding whether to 
  downgrade to leaf mode, and keeping distributed discovery services such as 
  <SPAN class=SpellE>GWebCaches</SPAN> updated<o:p></o:p></SPAN> </LI></UL>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36412889><SPAN lang=EN-AU>TCP Stream Connection and 
Handshaking</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H1></DIV>
<H2><A name=_Toc36412890><SPAN lang=EN-AU>Introduction</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>TCP stream connections are established 
between Gnutella2 nodes when they elect to form a permeant link, creating the 
fundamental network topology of a highly interconnected hub network serving 
dense clusters of leaf nodes.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412891><SPAN lang=EN-AU>Initiation</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>TCP connections are initiated by leaf or hub 
nodes in an attempt to gain a connection to a hub node.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Leaf nodes are never the target of an 
outbound connection.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The TCP port 
number is not standardised, and must be stored with the IP 
address.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412892><SPAN lang=EN-AU>Handshaking</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Upon the establishment of a TCP stream 
connection between two Gnutella2 nodes, a handshaking phase must be completed to 
negotiate the nature of the link and exchange other necessary 
information.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>This handshaking phase is the only part of 
the communication which remains compatible with the old Gnutella network, 
allowing new connections to be negotiated without fore-knowledge the 
capabilities of the other node.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The 
handshaking process has been well documented elsewhere, however a short summary 
is provided here.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412893><SPAN lang=EN-AU>Handshake Stages</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The Gnutella handshake process consists of 
three header blocks.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The node which 
initiated the connection sends an initial header block, of the 
form:<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>GNUTELLA CONNECT/0.6<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>Listen-IP: 1.2.3.4:6346<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>Remote-IP: 6.7.8.9<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>User-Agent: Shareaza 
1.8.2.0<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>Accept: 
application/x-gnutella2<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>X-Ultrapeer: False<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The receiver then responds with its own 
header block:<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>GNUTELLA/0.6 200 OK<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>Listen-IP: 6.7.8.9:6346<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>Remote-IP: 1.2.3.4<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>User-Agent: Shareaza 
1.8.2.0<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>Content-Type: 
application/x-gnutella2<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>Accept: 
application/x-gnutella2<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>X-Ultrapeer: True<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>X-Ultrapeer-Needed: False<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Finally, the initiator accepts the 
receiver’s header block, and provides any final 
information:<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>GNUTELLA/0.6 200 OK<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>Content-Type: 
application/x-gnutella2<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>X-Ultrapeer: False<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The latter two stages may be replaced with 
an error condition if the connection is being rejected.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Appropriate error status codes are 
returned in this case, for example:<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>GNUTELLA/0.6 503 Too many 
connections<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>(more headers)<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Note that only the HTTP-style error code 
should be interpreted by the software: any descriptive text provided is for 
display purposes only and is not standardised.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Important headers which are required or 
strongly recommended are detailed in the following 
sections.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412894><SPAN lang=EN-AU>Addressing Headers</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Two important headers to send on all 
connections are “Remote-IP” and “Listen-IP”.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Both of these headers should be sent on 
the first transmission, meaning in the first and second header blocks in the 
three block exchange.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The <B 
style="mso-bidi-font-weight: normal">Remote-IP</B> header contains the IP 
address from which the <I style="mso-bidi-font-style: normal">remote host</I> is 
connecting.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>This allows a remote 
host operating through some kind of network address translation system to learn 
its effective external address.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The <B 
style="mso-bidi-font-weight: normal">Local-IP</B> header contains the IP address 
and port number that the <I style="mso-bidi-font-style: normal">local host</I> 
is listening for inbound TCP connections on.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It should be listening for UDP datagrams 
on the same port.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The format of 
this header is “IP:PORT”, eg “1.2.3.4:6346”.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412895><SPAN lang=EN-AU>Identification</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The <B 
style="mso-bidi-font-weight: normal">User-Agent</B> header is used to identify 
the client software operating on the sending node.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It should be sent on the first 
transmission, meaning in the first and second header blocks in the three block 
exchange.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Note that this is a 
descriptive string that often includes a version number, and is not a “vendor 
code” as described elsewhere.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412896><SPAN lang=EN-AU>Content Type 
(Protocol)</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The <B 
style="mso-bidi-font-weight: normal">Accept</B> and <B 
style="mso-bidi-font-weight: normal">Content-Type</B> header exchange is used to 
negotiate the data protocol that will be used in the connection, in this case 
Gnutella2.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The Gnutella2 content 
type is “application/x-gnutella2”, and this exchange follows standard HTTP rules 
for negotiating content type.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The first step is to advertise support for 
the content type (Gnutella2) in the first header block with “Accept: 
application/x-gnutella2”.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The 
responding node will then indicate that it will send Gnutella2 content with 
“Content-Type: application/x-gnutella2”, and that it also supports Gnutella2 
with “Accept: application/x-gnutella2”.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>The initiating host then confirms that it will be sending Gnutella2 with 
“Content-Type: application/x-gnutella2” in the third header block.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>For more information on the 
Accept/Content-Type exchange, consult a HTTP reference.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Note that the content type negotiation 
process is designed to be a “one way” process, i.e. a different content type can 
be negotiated for sending and receiving.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>However when the gnutella2 protocol is negotiated, both channels must use 
the same content type.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>This means 
that a receiving node must not accept Gnutella2 if the initiator did not 
advertise support for it, and if at the end of the handshake bidirectional 
Gnutella2 was not negotiated, the connection should be 
terminated.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412897></A><st2:place><st2:PlaceName><SPAN 
style="mso-bookmark: _Toc36412897"><SPAN 
lang=EN-AU>Node</SPAN></SPAN></st2:PlaceName><SPAN 
style="mso-bookmark: _Toc36412897"><SPAN lang=EN-AU> 
</SPAN></SPAN><st2:PlaceType><SPAN style="mso-bookmark: _Toc36412897"><SPAN 
lang=EN-AU>State</SPAN></SPAN></st2:PlaceType></st2:place><SPAN 
style="mso-bookmark: _Toc36412897"><SPAN lang=EN-AU> 
Negotiation</SPAN></SPAN><SPAN lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>There are two node types in a Gnutella2 peer 
to peer network, a hub and a leaf as described in the “Node Types and 
Responsibilities” topic.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>During the 
initial handshake the two parties must exchange their current node type and 
<SPAN class=GramE>advise</SPAN> of their capabilities, negotiating the node 
types they will adopt when the connection completes, and indeed whether it 
should complete at all.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>As the handshake sequence is compatible with 
Gnutella1, the headers involved in negotiating node types are identical to those 
used to negotiate Gnutella1 “Ultrapeer” states:<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>X-Ultrapeer: [True|False]<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>X-Ultrapeer-Needed: 
[True|False]<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Both headers contain a Boolean value, “true” 
or “false”, case insensitive.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The <B 
style="mso-bidi-font-weight: normal">X-Ultrapeer</B> header indicates whether 
the transmitting node is currently operating as a hub.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Hub nodes will send “X-Ultrapeer: True” 
while leaf nodes will send “X-Ultrapeer: False”.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The <B 
style="mso-bidi-font-weight: normal">X-Ultrapeer-Needed</B> header indicates 
whether the transmitting node would like (and allow) the receiver to be a 
hub.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>A hub which sees no need for 
additional hubs in its area of the network will send “X-Ultrapeer-Needed: 
False”, indicating to the connecting node that it must operate in leaf mode if 
it wishes to connect.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>A hub which 
sees a need for additional hubs will send “X-Ultrapeer-Needed: True”, indicating 
that the receiving node should become a hub if it is capable of doing so.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>A leaf may send “X-Ultrapeer-Needed: 
True” to indicate that it is seeking a connection to a hub.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The <B 
style="mso-bidi-font-weight: normal">X-Ultrapeer</B> header should be sent on 
all three of the header blocks to indicate the current intended state of the 
node, while the <B style="mso-bidi-font-weight: normal">X-Ultrapeer-Needed</B> 
header should be sent in the first two header blocks only to indicate the 
desired status of the receiver.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If 
the nodes cannot agree on a satisfactory arrangement, the connection will be 
terminated at or prior to the third header block with an appropriate message, 
for example:</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>GNUTELLA/0.6 503 Too many hub 
connections</SPAN></P>
<P class=Code><SPAN lang=EN-AU>GNUTELLA/0.6 503 Too many leaves</SPAN></P>
<P class=Code><SPAN lang=EN-AU>GNUTELLA/0.6 503 I have leaves, can’t downgrade 
to leaf mode</SPAN></P>
<P class=Code><SPAN lang=EN-AU>GNUTELLA/0.6 503 Lead mode disabled</SPAN></P>
<H2><A name=_Toc36412898><SPAN lang=EN-AU>Hub Address Exchange</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>It is desirable for connecting nodes to 
exchange the node addresses of other hubs on the network to facilitate rapid 
connection.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The Gnutella2 protocol 
includes highly efficient methods to share hub addresses with peers once 
connected, but for a node trying to connect and encountering only “full” hubs, 
learning new hubs to try is helpful.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The <B 
style="mso-bidi-font-weight: normal">X-Try-<SPAN 
class=SpellE>Ultrapeers</SPAN></B> header was developed for this purpose, and 
like the rest of the handshake is also semi-compatible with Gnutella1.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It contains a comma separated list of 
hub node addresses and ports, along with a timestamp recording the time the hub 
was last seen.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>For 
example:</SPAN></P>
<P class=Code><SPAN lang=EN-AU>X-Try-Ultrapeers: 1.2.3.4:6346 2003-03-25T23:59Z, 
[..more..]</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Hub addresses should not be sent unless the 
transmitter has reasonable knowledge of the hub’s existence and the timestamp is 
not too old.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The content type 
negotiation headers should be used to verify that the listed hub addresses are 
indeed Gnutella2 hubs.</SPAN></P>
<H2><A name=_Toc36412899><SPAN lang=EN-AU>Compression Negotiation and 
Encoding</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The Gnutella2 architecture makes widespread 
use of “deflate” compression, due to its high availability and ease of 
integration.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Support of compressed 
TCP links is not a requirement in the Gnutella2 standard, however it is strongly 
recommended.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Deflate compression of a TCP link is 
negotiated with the standard HTTP headers pair “Accept-Encoding” and 
“Content-Encoding”.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>For 
example:</SPAN></P>
<P class=MsoNormal><SPAN class=GramE><SPAN lang=EN-AU>Header 
block</SPAN></SPAN><SPAN lang=EN-AU> one (initiator):</SPAN></P>
<P class=Code><SPAN lang=EN-AU>Accept-Encoding: deflate</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Header block two (receiver):</SPAN></P>
<P class=Code><SPAN lang=EN-AU>Accept-Encoding: deflate</SPAN></P>
<P class=Code><SPAN lang=EN-AU>Content-Encoding: deflate</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Header block three (initiator):</SPAN></P>
<P class=Code><SPAN lang=EN-AU>Content-Encoding: deflate</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>In this example the initiator advertises <I 
style="mso-bidi-font-style: normal">support</I> for a <I 
style="mso-bidi-font-style: normal">receiving</I> a deflated connection.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>The receiver then indicates that it too 
supports <I style="mso-bidi-font-style: normal">receiving</I> a deflated 
connection, and that it intends to transmit deflated data.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Finally, the initiator upon noting that 
the receiver supports deflate indicates that it too will transmit deflated 
data.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Note that unlike the content-type / protocol 
negotiation, deflated encoding can be applied on either incoming, outgoing or 
both channels of a connection.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>For performance reasons, nodes should 
consider whether they can afford to supports additional deflated connections 
before advertising support for them, or agreeing to provide a deflated data 
stream.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>In the Gnutella2 network 
topology, all links benefit from compression <I 
style="mso-bidi-font-style: normal">except</I> the <I 
style="mso-bidi-font-style: normal">leaf to hub</I> channel of the leaf/hub 
link.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Exempting this channel from 
compression saves the leaf and more importantly the hub a considerable CPU and 
RAM investment.</SPAN></P>
<H2><A name=_Toc36412900><SPAN lang=EN-AU>Post Handshake 
Communication</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>After the third and final header block has 
been received by the initiator, subsequent communication over the TCP stream 
occurs in the negotiated protocol, with the negotiated encoding.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>This means that while the handshake 
sequence was backwards compatible with Gnutella1, after Gnutella2 support has 
been negotiated all subsequent communication occurs in the Gnutella2 common 
protocol – an entirely new system <B 
style="mso-bidi-font-weight: normal">not</B> backwards compatible any other 
protocol.<o:p></o:p></SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36412901><SPAN lang=EN-AU>Gnutella2 UDP Semi-Reliable 
Transceiver</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H1></DIV>
<H2><A name=_Toc36412902><SPAN lang=EN-AU>Introduction</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The User Datagram Protocol (UDP) is 
invaluable in peer to peer systems because it provides a relatively low-cost 
(low-overhead) method of sending short, irregular messages to a very large 
number of peers on demand.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>Establishing a TCP stream connection to a peer simply to deliver a single 
packet of information is wasteful in data volume and time for the peers involved 
and state-aware network devices along the route, for example network address 
translation facilities.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>When 
dealing with a large number of peers quickly, these costs become 
unbearable.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>UDP provides a solution 
and makes this kind of interaction possible.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>However the delivery of UDP packets is not 
reliable: packets may be lost en-route for a number of reasons.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Often this behaviour is desirable, for 
example when the destination node’s connection is highly congested, UDP packets 
are likely to be discarded.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If the 
content was not critical, this loss is appropriate as the host’s resources are 
effectively unavailable.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>In other 
scenarios involving critical payloads, <SPAN class=SpellE>UDP’s</SPAN> lack of 
reliability is a problem: either the sender needs to make sure the receiver gets 
the payload, or it needs to know definitively that the receiver was 
unavailable.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The Gnutella2 network solves this problem by 
implementing a selectively engaged reliability layer on top of the basic UDP 
protocol.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>This reliability layer 
shares some common functionality with TCP, but importantly does not provide any 
connection state and thus retains the efficiency originally sought in 
UDP.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>This allows Gnutella2 to select the most 
optimal communication medium for each and every transmission it needs to 
perform:<o:p></o:p></SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l35 level1 lfo7"><SPAN lang=EN-AU>If 
  a significant volume of data is to be exchanged, or subsequent data will be 
  exchanged with the same destination, a TCP connection is 
  established<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l35 level1 lfo7"><SPAN lang=EN-AU>If 
  a small volume of important data is to be exchanged in a once-off operation or 
  irregularly, reliable UDP is used<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l35 level1 lfo7"><SPAN lang=EN-AU>If 
  a small volume of unimportant data is to be exchanged in a once-off operation 
  or irregularly, unreliable UDP is used<o:p></o:p></SPAN> </LI></UL>
<H2><A name=_Toc36412903><SPAN lang=EN-AU>UDP</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Gnutella2 semi-reliable communication is 
transported using the UDP protocol.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>The port number for receiving UDP is the same as the port number 
listening for TCP connections.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412904><SPAN lang=EN-AU>Encoding</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Implementing an additional reliable protocol 
within UDP requires a small control header before the payload itself.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>This header is put to good 
use:<o:p></o:p></SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l25 level1 lfo8"><SPAN lang=EN-AU>A 
  small signature identifies the packet as a Gnutella2 semi-reliable UDP 
  datagram.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>This allows the same 
  port to be used for receiving UDP traffic for other protocols if desired, and 
  offers some simple protection against random, unexpected 
  traffic.<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l25 level1 lfo8"><SPAN lang=EN-AU>A 
  content code identifies the payload as a Gnutella2 packet stream, allowing 
  future protocols to be added within the same reliability layer if 
  desired.<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l25 level1 lfo8"><SPAN 
  lang=EN-AU>Flags allow additional attributes to be specified, such as inline 
  stateless compression of the payload (which is a required 
  feature).<o:p></o:p></SPAN> </LI></UL>
<P class=MsoNormal><SPAN lang=EN-AU>The header has a fixed size of 8 bytes, and 
is represented by the following C structure:<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>#pragma pack(1)<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>typedef struct<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>{<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; 
</SPAN>CHAR<SPAN style="mso-tab-count: 1">&nbsp; 
</SPAN>szTag[3];<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; 
</SPAN>BYTE<SPAN style="mso-tab-count: 1">&nbsp; 
</SPAN>nFlags;<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; 
</SPAN>WORD<SPAN style="mso-tab-count: 1">&nbsp; 
</SPAN>nSequence;<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; 
</SPAN>BYTE<SPAN style="mso-tab-count: 1">&nbsp; 
</SPAN>nPart;<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; 
</SPAN>BYTE<SPAN style="mso-tab-count: 1">&nbsp; 
</SPAN>nCount;<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>} GND_HEADER;<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The members of the structure are detailed 
below:<o:p></o:p></SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l55 level1 lfo9"><SPAN 
  class=SpellE><SPAN class=GramE><B style="mso-bidi-font-weight: normal"><SPAN 
  lang=EN-AU>szTag</SPAN></B></SPAN></SPAN><SPAN lang=EN-AU> contains a three 
  byte encoding protocol identifier, in this case “GND” for 
  “</SPAN><st2:PersonName><st1:GivenName><SPAN class=SpellE><SPAN 
  lang=EN-AU>GNutella</SPAN></SPAN></st1:GivenName><SPAN lang=EN-AU> 
  </SPAN><st1:Sn><SPAN lang=EN-AU>Datagram</SPAN></st1:Sn></st2:PersonName><SPAN 
  lang=EN-AU>”.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If this signature 
  is not present the packet should not be decoded as a Gnutella2 reliability 
  layer transmission.<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l55 level1 lfo9"><SPAN 
  class=SpellE><SPAN class=GramE><B style="mso-bidi-font-weight: normal"><SPAN 
  lang=EN-AU>nFlags</SPAN></B></SPAN></SPAN><SPAN lang=EN-AU> contains flags 
  which modify the content of the packet.<SPAN style="mso-spacerun: yes">&nbsp; 
  </SPAN>The low-order nibble is reserved for critical flags: if one of these 
  bits is set but the decoding software does not understand the meaning, the 
  packet must be discarded.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The 
  high-order nibble is reserved for non-critical flags: when set these bits may 
  be interpreted, but an inability to interpret a bit does not cause the packet 
  to be discarded.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Currently 
  defined flags are:<BR><BR><B style="mso-bidi-font-weight: normal">0x01 : 
  </B>Deflate<BR><B style="mso-bidi-font-weight: normal">0x02 : </B>Acknowledge 
  Me<BR><BR>When the deflate bit is set, the entire payload is compressed with 
  the deflate algorithm.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Note that 
  the entire payload must be reassembled in the correct order before it can be 
  deflated if the packet was fragmented.<SPAN style="mso-spacerun: yes">&nbsp; 
  </SPAN>Fragments are not compressed separately!<BR><BR>When the acknowledge me 
  bit is set, the sender is expecting an acknowledgement for this packet.<B 
  style="mso-bidi-font-weight: normal"><o:p></o:p></B></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l55 level1 lfo9"><SPAN 
  class=SpellE><SPAN class=GramE><B style="mso-bidi-font-weight: normal"><SPAN 
  lang=EN-AU>nSequence</SPAN></B></SPAN></SPAN><SPAN lang=EN-AU> contains the 
  sequence number of the packet.<SPAN style="mso-spacerun: yes">&nbsp; 
  </SPAN>This sequence number is unique to the sending host only.<SPAN 
  style="mso-spacerun: yes">&nbsp; </SPAN>It is not unique to the pair of the 
  sending host and receiving host as in TCP, as there is no concept of 
  connection state.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Sequence 
  numbers on consecutive packets need not be increasing (although that is 
  convenient) – they must only be different.<SPAN 
  style="mso-spacerun: yes">&nbsp; </SPAN>If a packet is fragmented, all of its 
  fragments will have the same sequence number.<SPAN 
  style="mso-spacerun: yes">&nbsp; </SPAN>Byte order is unimportant here.<B 
  style="mso-bidi-font-weight: normal"><o:p></o:p></B></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l55 level1 lfo9"><SPAN 
  class=SpellE><B style="mso-bidi-font-weight: normal"><SPAN 
  lang=EN-AU>nPart</SPAN></B></SPAN><SPAN lang=EN-AU> contains the fragment part 
  number (1 &lt;= <SPAN class=SpellE>nPart</SPAN> &lt;= <SPAN 
  class=SpellE>nCount</SPAN>)<B 
  style="mso-bidi-font-weight: normal"><o:p></o:p></B></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l55 level1 lfo9"><SPAN 
  class=SpellE><SPAN class=GramE><B style="mso-bidi-font-weight: normal"><SPAN 
  lang=EN-AU>nCount</SPAN></B></SPAN></SPAN><SPAN lang=EN-AU> contains the 
  number of fragment parts in this packet.<SPAN style="mso-spacerun: yes">&nbsp; 
  </SPAN>On a transmission, this value will be non-zero (all packets must have 
  at least one fragment).<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If <SPAN 
  class=SpellE>nCount</SPAN> is zero, this is an acknowledgement (see below).<B 
  style="mso-bidi-font-weight: normal"><o:p></o:p></B></SPAN> </LI></UL>
<H2><A name=_Toc36412905><SPAN lang=EN-AU>Fragmentation</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Large packets must be fragmented before they 
can be sent through most network interfaces.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Different network media have different 
<SPAN class=SpellE>MTUs</SPAN>, and it is difficult to predict what the lowest 
common size will be.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Fragmentation 
and reassembly is performed by the existing Internet protocols, however there 
are two important reasons why the reliability layer performs its own 
fragmentation:<o:p></o:p></SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l48 level1 lfo10"><SPAN 
  lang=EN-AU>Sockets implementations specify a maximum datagram size.<SPAN 
  style="mso-spacerun: yes">&nbsp; </SPAN>This is adequate for the vast majority 
  of transmissions, but it is desirable to have the transparent ability to send 
  larger packets without worrying about the host 
  implementation.<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l48 level1 lfo10"><SPAN 
  lang=EN-AU>When the Internet protocols fragment a packet and one or more 
  fragments are lost, it may decide to discard the whole packet in an unreliable 
  datagram protocol.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The Gnutella2 
  reliability layer can compensate by retransmitting the whole packet, which 
  would then be re-fragmented and each fragment resent – however this wastes the 
  fragments that were successfully received before.<SPAN 
  style="mso-spacerun: yes">&nbsp; </SPAN>Managing fragmentation natively allows 
  this optimisation.<o:p></o:p></SPAN> </LI></UL>
<P class=MsoNormal><SPAN lang=EN-AU>Each node determines its own MTU, often 
based on a best guess combined with information from the host’s sockets 
implementation.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Packets exceeding 
this size are fragmented into multiple datagrams of the appropriate size.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Each datagram has the same sequence 
number and the same fragment count (<SPAN class=SpellE>nCount</SPAN>), but a 
different fragment number (<SPAN 
class=SpellE>nPart</SPAN>).<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412906><SPAN lang=EN-AU>Transmission Process</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>When a packet is to be transmitted the 
network layer must:<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 39.3pt; TEXT-INDENT: -18pt; tab-stops: list 39.3pt; mso-list: l27 level1 lfo11"><![if !supportLists]><SPAN 
lang=EN-AU 
style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN 
style="mso-list: Ignore">·<SPAN 
style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><![endif]><SPAN lang=EN-AU>Cache the 
payload<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 39.3pt; TEXT-INDENT: -18pt; tab-stops: list 39.3pt; mso-list: l27 level1 lfo11"><![if !supportLists]><SPAN 
lang=EN-AU 
style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN 
style="mso-list: Ignore">·<SPAN 
style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><![endif]><SPAN lang=EN-AU>Allocate a new locally and 
temporally unique sequence number<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 39.3pt; TEXT-INDENT: -18pt; tab-stops: list 39.3pt; mso-list: l27 level1 lfo11"><![if !supportLists]><SPAN 
lang=EN-AU 
style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN 
style="mso-list: Ignore">·<SPAN 
style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><![endif]><SPAN lang=EN-AU>Derive the appropriate number of 
fragments<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 39.3pt; TEXT-INDENT: -18pt; tab-stops: list 39.3pt; mso-list: l27 level1 lfo11"><![if !supportLists]><SPAN 
lang=EN-AU 
style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN 
style="mso-list: Ignore">·<SPAN 
style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><![endif]><SPAN lang=EN-AU>Queue the fragments for 
dispatch<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 39.3pt; TEXT-INDENT: -18pt; tab-stops: list 39.3pt; mso-list: l27 level1 lfo11"><![if !supportLists]><SPAN 
lang=EN-AU 
style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN 
style="mso-list: Ignore">·<SPAN 
style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><![endif]><SPAN lang=EN-AU>If the fragments do not need to 
be acknowledged, the packet can be flushed now<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The payload will generally be cached for an 
appropriate timeout period, or until the data cache becomes full at which time 
older payloads can be discarded.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>Fragments are dispatched according to the dispatch algorithm of choice, 
and the sender listens for acknowledgements.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>When an acknowledgement is 
received:<o:p></o:p></SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l32 level1 lfo12"><SPAN 
  lang=EN-AU>Lookup the sent packet by sequence number<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l32 level1 lfo12"><SPAN 
  lang=EN-AU>Mark the <SPAN class=SpellE>nPart</SPAN> fragment as received and 
  cancel any retransmissions of this part<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l32 level1 lfo12"><SPAN lang=EN-AU>If 
  all fragments have been acknowledged, flush this packet from the 
  cache<o:p></o:p></SPAN> </LI></UL>
<P class=MsoNormal><SPAN lang=EN-AU>If a fragment has been transmitted but has 
not been acknowledged within the timeout, it should be retransmitted.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>A finite number of retransmissions are 
allowed before the packet as a whole expires, at which time it is assumed that 
the packet was not received.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412907><SPAN lang=EN-AU>Receive Process</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>When a new datagram is received, the network 
layer must:<o:p></o:p></SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l51 level1 lfo13"><SPAN lang=EN-AU>If 
  the acknowledge bit was set, send an acknowledge packet for this sequence 
  number and part number, with <SPAN class=SpellE>nCount</SPAN> set to zero 
  (<SPAN class=SpellE>ack</SPAN>)<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l51 level1 lfo13"><SPAN 
  lang=EN-AU>Lookup any existing packet by the sending IP and sequence 
  number<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l51 level1 lfo13"><SPAN lang=EN-AU>If 
  there is no existing packet, create a new packet entry with the IP, sequence 
  number, fragment count and flags<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l51 level1 lfo13"><SPAN lang=EN-AU>If 
  there was an existing packet, make sure it is not marked as done – if so, 
  abort<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l51 level1 lfo13"><SPAN 
  lang=EN-AU>Add the transmitted fragment to the (new or old) packet 
  entry<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l51 level1 lfo13"><SPAN lang=EN-AU>If 
  the packet now has all fragments, mark it as done and decode it and pass it up 
  to the application layer<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l51 level1 lfo13"><SPAN 
  lang=EN-AU>Leave the packet on the cache even if it was finished, in case any 
  parts are retransmitted<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l51 level1 lfo13"><SPAN 
  lang=EN-AU>Expire old packets from the receive buffer after a timeout or if 
  the buffer is full<o:p></o:p></SPAN> </LI></UL>
<H2><A name=_Toc36412908><SPAN lang=EN-AU>Dispatch Algorithm</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Fragment datagrams need to be dispatched 
intelligently to spread the load on network resources and maximise the chance 
that the receiver will get the message.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>To do this, the dispatch algorithm should take into account several 
points:<o:p></o:p></SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l33 level1 lfo14"><SPAN 
  lang=EN-AU>Prioritize acknowledgements.<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l33 level1 lfo14"><SPAN lang=EN-AU>If 
  fragments are waiting to be sent to a number of hosts, do not send to the same 
  host twice in a row.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Alternating 
  or looping through the target hosts achieves the same data rate locally, but 
  spreads out the load over downstream links.<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l33 level1 lfo14"><SPAN lang=EN-AU>Do 
  not exceed or approach the capacity of the local network connection.<SPAN 
  style="mso-spacerun: yes">&nbsp; </SPAN>If a host has a 128 kb/s outbound 
  bandwidth, dispatching 32 KB of data in one second will likely cause massive 
  packet loss, leading to a retransmission.<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l33 level1 lfo14"><SPAN 
  lang=EN-AU>After considering the above points, prefer fragments that were 
  queued recently to older packets.<SPAN style="mso-spacerun: yes">&nbsp; 
  </SPAN>A LIFO or stack type approach means that even if a transmitter is 
  becoming backed up, some fragments will get there on time while others will be 
  delayed.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>A FIFO approach would 
  mean that a backed up host delivers every fragment late.<o:p></o:p></SPAN> 
  </LI></UL>
<H2><A name=_Toc36412909><SPAN lang=EN-AU>Parameters</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The recommended parameters for the 
reliability layer are as follows:<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>MTU = 500 bytes<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Transmit Retransmit Interval = 10 
seconds<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Transmit Packet Timeout / Expire = 26 
seconds<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>(<SPAN class=GramE>allows</SPAN> for two 
retransmissions before expiry)<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Receive Packet Expiry = 30 
seconds<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>(<SPAN class=GramE>allows</SPAN> 10 seconds 
beyond final retransmission)<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412910><SPAN lang=EN-AU>Performance 
Considerations</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Relatively low-level network implementations 
such as this are reasonably complicated, but must operate fast.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It is desirable to avoid runtime memory 
allocations in network code as much as possible, and particularly at this 
level.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>It should be noted that in almost all cases, 
transmissions to “untested” nodes are single fragment.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Replies on the other hand are often 
larger, and may be deflated in many fragments.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>This is optimal because attempting to 
contact a node which may be unavailable involves a retransmission of only a 
single fragment.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Flow control is an important topic, however 
it is handled at a higher layer.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>The UDP reliability layer is only responsible for guaranteeing delivery 
of selected datagrams.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Only critical transmissions whose reception 
cannot otherwise be inferred should have the acknowledge request bit 
set.<o:p></o:p></SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36412911><SPAN lang=EN-AU>Gnutella2 Packet 
Structure</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H1></DIV>
<H2><A name=_Toc36412912><SPAN lang=EN-AU>Introduction</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>All Gnutella2 communications are represented 
with Gnutella2 lightweight tree packets.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>This applies everywhere from TCP stream communications to reliable UDP 
transmissions to HTTP packet exchanges (where protocol data has been 
negotiated).<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Each tree packet may 
contain meaningful payload data and/or one or more child packets, allowing 
complex document structures to be created and extended in a backward compatible 
manner.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The concept can be compared to an XML 
document tree.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The “packets” are 
elements, which can in turn contain zero or more child elements (packets).<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>The payload of a packet is like the 
attributes of an XML element.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>However serializing XML has a lot of overhead due to all the naming, even 
in a compact binary form.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The 
Gnutella2 packet structure makes a compromise: it names elements (packets), 
allowing them to be globally recognized and understood without knowledge of 
their format – and stores attributes as binary payloads, requiring knowledge of 
their content to parse them.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Thus the element (packet or child packet) is 
the finite unit of comprehension.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>This system provides an excellent trade-off between format transparency 
and compactness.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412913><SPAN lang=EN-AU>Fictitious Visual 
Example</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>+ Query Hit Packet<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>|<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>|-+ Node ID (standard)<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>|<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>|-+ Server Status (standard)<BR>| \-+ Shareaza 
Server Status (private extension)<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>|<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>|-+ Hit Object<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>| |-+ URN (standard)<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>| |-+ Descriptive name 
(standard)<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>| | \-+ Alternate name list 
(extension)<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>| |-+ URL (standard)<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>| |-+ Priority indicator (private 
extension)<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>| | \-+ Digital signature 
(private)<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>| |-+ Alternate source summary 
(standard)<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>| \-+ Available ranges 
(standard)<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>| . \-+ Estimated completion time (private 
extension)<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>|<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>|-+ Selective digital signature 
(private)<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>|<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>\-+ Routing tags<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412914><SPAN lang=EN-AU>Contents</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Each Gnutella2 packet 
contains:<o:p></o:p></SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l36 level1 lfo5"><SPAN 
  lang=EN-AU>Control flags<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l36 level1 lfo5"><SPAN lang=EN-AU>A 
  type name meaningful in the namespace of the packet’s parent or 
  context<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l36 level1 lfo5"><SPAN lang=EN-AU>A 
  length (or implied length)<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l36 level1 lfo5"><SPAN 
  lang=EN-AU>Payload data of a format specific to the packet type name and 
  namespace<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l36 level1 lfo5"><SPAN 
  lang=EN-AU>Child packets existing in the namespace of this 
  packet<o:p></o:p></SPAN> </LI></UL>
<H2><A name=_Toc36412915><SPAN lang=EN-AU>Namespace 
Considerations</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Each packet contains a relative type name of 
up to 8 bytes in length, which are case sensitive.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>The packet type name is meaningful only 
in the namespace of the packet’s parent, or in the absence of a parent, the 
context of the packet (e.g. root level TCP stream).<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>This means that, for example a packet “A” 
inside packet “X” is different to a packet “A” inside packet “Y”.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Packets are of the same type only if 
their fully qualified absolute type names are equal.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>As a convention, when discussing packet type 
names, they will be noted in their absolute form with a URL style slash (/) 
separating each level.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>In the above 
example, the first packet is “/X/A” while the second is “/Y/A”.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It is clear now that the packets are of 
different types.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Packet type names can contain from 1 to 8 
bytes inclusive, and none of these bytes may be a null (0).<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Community approved packets are by 
convention named with uppercase characters and digits, for example “PUSH”.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Private packet types are by convention 
named with lowercase characters and digits, prefixed with the vendor code of the 
owner, for example “RAZAclr2”.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412916><SPAN lang=EN-AU>Framing</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Packets are encoded with a single leading 
control byte, followed by one or more bytes of packet length, followed by one or 
more bytes of packet name/ID, followed by zero or more child packets (framed the 
same way), followed by zero or more bytes of payload:<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN 
lang=EN-AU>+---------+----/----+----/----+-------------/-----------+<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>| Control | Length_ | Name___ | children and/or 
payload |<o:p></o:p></SPAN></P>
<P class=Code><SPAN 
lang=EN-AU>+---------+----/----+----/----+-------------/-----------+<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>All packets can contain a payload only, 
children and a payload, children only, or nothing at all.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>The total length of the packet header 
(control, length and type name) cannot exceed 12 bytes and cannot be less than 2 
bytes.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412917><SPAN lang=EN-AU>The Control Byte</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The control byte is always non-zero.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>A zero control byte identifies the end 
of a stream of packets, and thus has special meaning.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It should not be used in root packet 
streams (which do not end).<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Control bytes have the following 
format:<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>Bit 7 &lt; - &gt; Bit 0<o:p></o:p></SPAN></P>
<P class=Code><SPAN 
lang=EN-AU>+----+----+----+----+----+----+----+----+<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>| Len_Len | Name_Len – 1 | CF | BE | // 
|<o:p></o:p></SPAN></P>
<P class=Code><SPAN 
lang=EN-AU>+----+----+----+----+----+----+----+----+<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l42 level1 lfo6"><B 
  style="mso-bidi-font-weight: normal"><SPAN lang=EN-AU>Len_Len</SPAN></B><SPAN 
  lang=EN-AU> is the number of bytes in the length field of the packet, which 
  immediately follows the control byte.<SPAN style="mso-spacerun: yes">&nbsp; 
  </SPAN>There are two bits here which means the length field can be up to 3 
  bytes long.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Len_Len can be zero 
  if the packet has zero length (no children and no payload), in which case 
  there is no need to encode the length.<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l42 level1 lfo6"><B 
  style="mso-bidi-font-weight: normal"><SPAN lang=EN-AU>Name_Len</SPAN></B><SPAN 
  lang=EN-AU> is the number of bytes in the packet name field MINUS ONE, which 
  follows the packet length field.<SPAN style="mso-spacerun: yes">&nbsp; 
  </SPAN>There are three bits here which means that packet names can be 1 to 8 
  bytes long inclusive.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Because a 0 
  here equates to one byte of name, unnamed packets are not 
  possible.<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l42 level1 lfo6"><SPAN lang=EN-AU>The 
  three least significant bits of the control byte are reserved for flags.<SPAN 
  style="mso-spacerun: yes">&nbsp; </SPAN>They have the following 
  meanings:<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l42 level1 lfo6"><B 
  style="mso-bidi-font-weight: normal"><SPAN lang=EN-AU>CF</SPAN></B><SPAN 
  lang=EN-AU> is the compound packet flag.<SPAN style="mso-spacerun: yes">&nbsp; 
  </SPAN>If this bit is set, the packet contains one or more child packets.<SPAN 
  style="mso-spacerun: yes">&nbsp; </SPAN>If not set, the packet does not 
  contain any child packets.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If the 
  packet is of zero length, this flag is ignored.<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l42 level1 lfo6"><B 
  style="mso-bidi-font-weight: normal"><SPAN lang=EN-AU>BE</SPAN></B><SPAN 
  lang=EN-AU> is the big-endian packet flag.<SPAN 
  style="mso-spacerun: yes">&nbsp; </SPAN>If set, all multi-byte values encoded 
  in the packet and its children are encoded in big-endian byte order – 
  including the length in the packet header.<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l42 level1 lfo6"><SPAN 
  lang=EN-AU>Other bits are reserved.<o:p></o:p></SPAN> </LI></UL>
<H2><A name=_Toc36412918><SPAN lang=EN-AU>The Length Field</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The length field immediately follows the 
control byte, and can be 0 to 3 bytes long.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Length bytes are stored in the byte 
order of the packet.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The length value includes the payload of 
this packet AND any child packets in their entirety.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>This is obviously needed so that the 
entire packet can be detected and acquired from a stream.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>The length does not include the header 
(control byte, length, and name).<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>The length field precedes the name field to allow it to be read faster 
from a stream when acquiring packets.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The length field is in the byte order of the 
root packet.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412919><SPAN lang=EN-AU>The Type Name Field</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The type name field immediately follows the 
length bytes, and can be from 1 to 8 bytes long.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Its format is detailed in the previous 
section entitled “Namespace Considerations”.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412920><SPAN lang=EN-AU>Child Packets</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Child packets are only present if the 
“compound packet bit” is set in the control byte.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>If set, there is one or more child 
packet immediately following the end of the header.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>These child packets are included in the 
total length of their parent (along with the payload, which follows the child 
packets after a packet stream terminator).<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Child packets are framed exactly the same 
way, with a control byte, length, name, children and/or payload.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>When the compound bit is set and the 
packet is not of zero length, the first child packet must exist.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Subsequent child packets may also exist, 
and are read in sequentially in the same way that they are read from a root 
packet stream.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The end of the child 
packet stream is signalled by the presence of a zero control byte, OR the end of 
the parent packet’s length (in which case there is no payload).<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Including a terminating zero control 
byte when there is no payload is still valid, but 
unnecessary.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412921><SPAN lang=EN-AU>Payload</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Payload may exist whenever the length field 
is non-zero.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>However, if the 
compound bit is set, one or more child packets must be read before the payload 
is reached.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If there is no packet 
left after the end of the last child, there is no payload.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412922><SPAN lang=EN-AU>Notes on the Control 
Byte</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Note that there are a number of “marker 
packet types”, which have no children or payload.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It is desirable to encode these in as 
small a space as possible, which means omitting the length field and setting the 
len_len bits to zero in the control byte.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>This creates a potential conflict, as the control byte itself may be zero 
if the type name is one byte long – and as noted above, a zero control byte has 
special meaning (end of packet stream).<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>This must be avoided; luckily it is perfectly legal to set the compound 
packet flag (CF) on zero length packets, thus producing a non-zero control byte 
and the most compact packet possible.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The compound packet bit MUST be checked when 
decoding every packet.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>It should be 
done in low-level decoding code to avoid accidental omission.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Do not assume that a packet will not 
have children – it might not now, but no packets are sterile.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Anything could be augmented or extended 
in some unknown way in the future.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>If you are not interested in children, skip them (which is easy, you 
don’t even need to recurs through their children).<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412923><SPAN lang=EN-AU>Simple Packet Decoder in 
C</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>BYTE nInput<SPAN 
style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>= ReadNextByte();<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>if ( nInput == 0 ) return 
S_NO_MORE_CHILDREN;<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>BYTE nLenLen<SPAN 
style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; </SPAN>= ( nInput &amp; 0xC0 ) 
&gt;&gt; 6;<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>BYTE nTypeLen<SPAN 
style="mso-tab-count: 1">&nbsp;&nbsp; </SPAN>= ( nInput &amp; 0x38 ) &gt;&gt; 
3;<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>BYTE nFlags<SPAN 
style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>= ( nInput &amp; 0x07 );<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>BOOL bBigEndian<SPAN 
style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>= ( nFlags 
&amp; 0x02 ) ? TRUE : FALSE;<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>BOOL bIsCompound<SPAN 
style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>= ( nFlags &amp; 
0x04 ) ? TRUE : FALSE;<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>ASSERT( ! bBigEndian );</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>DWORD nPacketLength = 0;</SPAN></P>
<P class=Code><SPAN lang=EN-AU>ReadBytes( (BYTE*)&amp;nPacketLength, nLenLen 
);<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>CHAR szType[9];<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>ReadBytes( (BYTE*)szType, nTypeLen + 1 
);<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>szType[ nTypeLen + 1 ] = 0;<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36412924><SPAN lang=EN-AU>Datatypes</SPAN></A></H1></DIV>
<H2><A name=_Toc36412925><SPAN lang=EN-AU>Introduction</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The format of a packet payload is defined by 
the packet type and can consist of any binary data; however there are a number 
of conventions in place for serializing common datatypes.</SPAN></P>
<H2><A name=_Toc36412926><SPAN lang=EN-AU>Multi-Byte Integers</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Multi-byte integers are serialized in the 
byte-order of the topmost packet.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>Little-endian is the default byte-order; however big-endian byte order 
can be selected for those who want it.</SPAN></P>
<H2><A name=_Toc36412927><SPAN lang=EN-AU>Network/Node Addresses</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>A network or node address consists of a 
physical address and a port number, and are of variable length depending on the 
address family.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>In IPv4, a network/node address is six bytes 
long: 4 bytes for an IP address and 2 bytes for a port number as 
follows:</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>typedef struct</SPAN></P>
<P class=Code><SPAN lang=EN-AU>{</SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; 
</SPAN>BYTE<SPAN style="mso-tab-count: 1">&nbsp; </SPAN>ip[4];</SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; 
</SPAN>SHORT<SPAN style="mso-tab-count: 1"> </SPAN>port;</SPAN></P>
<P class=Code><SPAN lang=EN-AU>} IPV4_ENDPOINT;</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Note that this is considered an array of 4 
8-bit integers (bytes), followed by a 16-bit integer (short).<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Byte order does not affect bytes, but it 
will affect the 16-bit port number.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>IPv6 addresses are longer and are not yet 
defined within the scope of Gnutella2, however applications should be aware that 
if the node address is not 6 bytes it is of a different address 
family.</SPAN></P>
<H2><A name=_Toc36412928><SPAN lang=EN-AU>GUIDs</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Globally unique identifiers (GUIDs) are used 
to identify nodes on the network.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>GUIDs are serialized as an array of 16 bytes.</SPAN></P>
<H2><A name=_Toc36412929><SPAN lang=EN-AU>Strings</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Strings are serialized as a zero-terminated 
array of 8 or 16 bit integers, with byte order considerations applying if 16 bit 
integers are used.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>16 bit storage 
is selected by storing a single 0xFF byte before the string – a traditional 
byte-order mark is not required because the byte order has already defined for 
the packet as a whole.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>A zero character (0x00 or 0x0000) marks the 
end of the string, however if the string data meets the end of the packet (or 
child packet) payload, the terminator is not required.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>This means that packets whose payload 
consists of a string do not need to include a zero string terminator and their 
payload length will be the byte length of the encoded string exactly.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>When 16-bit mode is selected, the string is 
serialized in 16-bit Unicode.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Most 
runtime environments provide tools for working with 16-bit Unicode 
text.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>When 8-bit mode is selected, the string is 
serialized in UTF-8.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>7-bit 
characters are passed as-is, while extended characters are encoded with 
multi-byte sequences.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>All applications are required to support 
decoding both 8 and 16 bit strings, however it is up to each application which 
string format to encode with.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>For 
example it is acceptable to send all strings as 16-bit Unicode if 
desired.<o:p></o:p></SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36412930><SPAN lang=EN-AU>Basic Network 
Maintenance</SPAN></A></H1></DIV>
<H2><A name=_Toc36412931><SPAN lang=EN-AU>Introduction</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Once TCP stream connections have been 
established forming the overall network topology, a set of basic packet types 
and behaviours are used to keep the network together and perform maintenance 
functions.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>These maintenance packets are documented in 
this section, each with name, payload, children and behaviours.</SPAN></P>
<H2><A name=_Toc36412932><SPAN lang=EN-AU>/PI - (</SPAN></A><st1:GivenName><SPAN 
style="mso-bookmark: _Toc36412932"><SPAN 
lang=EN-AU>Ping</SPAN></SPAN></st1:GivenName><SPAN 
style="mso-bookmark: _Toc36412932"><SPAN lang=EN-AU>)</SPAN></SPAN></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The ping packet is used to verify the 
presence of the addressed node, testing that:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l23 level1 lfo17"><SPAN 
  lang=EN-AU>The destination node is online</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l23 level1 lfo17"><SPAN 
  lang=EN-AU>The destination node can receive the transmission</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l23 level1 lfo17"><SPAN 
  lang=EN-AU>The local node can receive the reply</SPAN> </LI></UL>
<P class=MsoNormal><SPAN lang=EN-AU>Aside from performing a “keep-alive” 
function on TCP links, pings can be used to solicit inbound UDP datagrams to 
test the local node’s ability to receive UDP.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Many NAT systems will route UDP traffic 
from nodes with whom a persistent TCP stream has been established, so it is 
necessary to test inbound traffic from nodes with which there is no TCP 
connection.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>This is achieved by 
sending a ping with a /PI/UDP packet to a connected hub via TCP, which will 
forward the request to its neighbours who then reply to the originator via 
UDP.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>On a TCP stream connection, if one end has 
not received a valid packet from the other after an internally determined period 
of time, it has the option of sending a keep-alive ping to verify the other 
end’s presence.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If a pong is not 
received in a timeout period it may close the connection.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>If a node needs to verify that it is able to 
receive UDP datagrams from nodes with which it does not have a TCP stream 
connection, it may send a ping packet with a /PI/UDP child packet.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>If it then receives a 
/</SPAN><st2:place><SPAN lang=EN-AU>PO</SPAN></st2:place><SPAN lang=EN-AU> 
(pong) packet with a /PO/RELAY child tag and there is no TCP connection to the 
sender, it can assume it is able to receive UDP.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Upon receiving a keep-alive ping, a node 
should respond with a keep-alive pong immediately.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>If the ping was received from a TCP 
neighbour and contains a /PI/UDP child packet, but no /PI/RELAY tag, a /PI/RELAY 
tag should be added and the packet forwarded to all neighbouring hubs.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>If a /PI/RELAY tag was present, the node 
should send a /PO packet with a /PO/RELAY tag to the UDP address identified in 
the /PI/UDP child packet.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no payload at the current 
time.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The ping packet has two child packets 
defined at the current time:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l16 level1 lfo18"><SPAN 
  lang=EN-AU>/PI/RELAY</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l16 level1 lfo18"><SPAN 
  lang=EN-AU>/PI/UDP<o:p></o:p></SPAN> </LI></UL>
<H2><A name=_Toc36412933><SPAN lang=EN-AU>/PI/RELAY – Relayed 
</SPAN></A><st2:PersonName><st1:GivenName><SPAN 
style="mso-bookmark: _Toc36412933"><SPAN 
lang=EN-AU>Ping</SPAN></SPAN></st1:GivenName><SPAN 
style="mso-bookmark: _Toc36412933"><SPAN lang=EN-AU> </SPAN></SPAN><st1:Sn><SPAN 
style="mso-bookmark: _Toc36412933"><SPAN 
lang=EN-AU>Marker</SPAN></SPAN></st1:Sn></st2:PersonName></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>If a /PI packet contains a /PI/RELAY child 
marker, the ping has been relayed for a third party.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>The receiving node should reply to the 
original party rather than the sender.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>The original party should be contacted via UDP with the address contained 
in the /PI/UDP child.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If the 
/PI/UDP child is absent, the packet is invalid.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /PI/RELAY child should be added to a /PI 
packet when relaying a ping to hub neighbours at the request of a 
leaf.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Upon receiving a /PI packet with a /PI/RELAY 
tag, a /</SPAN><st2:place><SPAN lang=EN-AU>PO</SPAN></st2:place><SPAN 
lang=EN-AU> (pong) packet should be sent via UDP to the node identified in the 
/PI/UDP child.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no payload at the current 
time.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412934><SPAN lang=EN-AU>/PI/UDP – 
</SPAN></A><st2:PersonName><st1:GivenName><SPAN 
style="mso-bookmark: _Toc36412934"><SPAN 
lang=EN-AU>Ping</SPAN></SPAN></st1:GivenName><SPAN 
style="mso-bookmark: _Toc36412934"><SPAN lang=EN-AU> </SPAN></SPAN><st1:Sn><SPAN 
style="mso-bookmark: _Toc36412934"><SPAN 
lang=EN-AU>Response</SPAN></SPAN></st1:Sn></st2:PersonName><SPAN 
style="mso-bookmark: _Toc36412934"><SPAN lang=EN-AU> Address</SPAN></SPAN></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /PI/UDP child packet specifies the 
return address for a relay able or relayed ping.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Add a /PI/UDP child packet to a /PI packet 
to request a relayed “two hop” ping.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /PI/UDP child packet indicates that a 
/PI packet needs to be relayed.<o:p></o:p></SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /PI/UDP packet contains an endpoint 
address.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412935><SPAN lang=EN-AU>/</SPAN></A><st2:place><SPAN 
style="mso-bookmark: _Toc36412935"><SPAN 
lang=EN-AU>PO</SPAN></SPAN></st2:place><SPAN 
style="mso-bookmark: _Toc36412935"><SPAN lang=EN-AU> – Pong</SPAN></SPAN></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The pong packet serves as a reply to a one 
or two hop ping (/PI) packet.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>It 
indicates that the pinged node received and processed the ping, and in the case 
of UDP, that the local node was able to received UDP from the sender.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Send a pong packet in response to a direct 
or relayed ping request.<o:p></o:p></SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>No action is required in response to a pong 
packet.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If the packet contains a 
/PO/RELAY marker child, test the sender’s network address against the list of 
active TCP connections and if there is no match, consider the local node able to 
receive UDP.<o:p></o:p></SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no payload at the current 
time.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The ping packet has one child packet type 
defined at the current time:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l16 level1 lfo18"><SPAN 
  lang=EN-AU>/PO/RELAY</SPAN> </LI></UL>
<H2><A name=_Toc36412936><SPAN lang=EN-AU>/PO/RELAY – Relayed Pong 
Marker</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>If a /</SPAN><st2:place><SPAN 
lang=EN-AU>PO</SPAN></st2:place><SPAN lang=EN-AU> packet contains a /PO/RELAY 
child marker, the pong was sent in response to a relayed ping.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /PO/RELAY child marker should be added 
to a /</SPAN><st2:place><SPAN lang=EN-AU>PO</SPAN></st2:place><SPAN lang=EN-AU> 
if the pong is being sent in response to a relayed ping.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>No specific action is required for a relayed 
pong.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no payload at the current 
time.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412937><SPAN lang=EN-AU>/LNI – Local Node 
Information</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The local node information packet is used to 
convey essential information about the node on either end of a TCP stream 
connection.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /LNI packet should be sent to a TCP 
neighbour upon connection, and at regular intervals following that if the 
information within it has changed.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>A minimum update time of one minute is recommended.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Upon receiving a /LNI packet, the 
information within should be stored for subsequent use.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no payload at the current 
time.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /LNI packet has many child packet types 
defined at the current time:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l16 level1 lfo18"><SPAN 
  lang=EN-AU>/LNI/NA – Node Address</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l16 level1 lfo18"><SPAN 
  lang=EN-AU>/LNI/GU – GUID</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l16 level1 lfo18"><SPAN 
  lang=EN-AU>/LNI/V – Vendor Code</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l16 level1 lfo18"><SPAN 
  lang=EN-AU>/LNI/LS – Library Statistics</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l16 level1 lfo18"><SPAN 
  lang=EN-AU>/LNI/HS – Hub Status<o:p></o:p></SPAN> </LI></UL>
<H2><A name=_Toc36412938><SPAN lang=EN-AU>/LNI/NA – Node Address</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /LNI/NA child packet specifies the node 
or network address of the sending node.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is required.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload<o:p></o:p></SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The physical network address of the sending 
node.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>See datatypes for more 
information.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.</SPAN></P>
<H2><A name=_Toc36412939><SPAN lang=EN-AU>/LNI/GU – GUID</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /LNI/GU child packet specifies the 
globally unique identifier of the sending node.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is required.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload<o:p></o:p></SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The 16 byte globally unique node identifier 
of the sending node. </SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412940><SPAN lang=EN-AU>/LNI/V – Vendor Code</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /LNI/V child packet specifies the vendor 
code of the software operating the sending node.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is optional.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A four byte vendor code.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412941><SPAN lang=EN-AU>/LNI/LS – Library 
Statistics</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /LNI/LS packet provides information 
about the content library of the sending node.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is optional.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload<o:p></o:p></SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Two 32-bit integers representing the number 
of files in the local library, and the total KB in the local library 
respectively.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If the sending node 
is a hub these statistics are combined with the known statistics from all 
connected leaves.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The payload may 
grow beyond 8 bytes in the future.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412942><SPAN lang=EN-AU>/LNI/HS – Hub Status</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /LNI/HS packet is included only if the 
sending node is a hub, and contains the status of the hub.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child packet should only be sent by hub 
nodes.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Leaf nodes should not 
transmit it, and if it is received from a leaf node, it should be 
ignored.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Two 16-bit integers representing the current 
leaf count and the maximum leaf count respectively.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>This packet may grow beyond 4 bytes in 
the future.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36412943><SPAN lang=EN-AU>/KHL – Known Hub 
List</SPAN></A></H1></DIV>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The known hub list packet is used to 
exchange a list of known Gnutella2 hubs with neighbouring nodes.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It is exchanged regularly over all TCP 
connections, between hubs and between hubs and leaves (and vice versa).<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It enables a completely up to date 
picture of the local hub cluster, and the gradual propagation of cached hub 
records.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet should be sent through TCP links 
at regular intervals.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>One minute is 
suggested for busy links, leaves may send to hubs less often.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Note that unlike /LNI, /KHL must be sent 
regularly even if the information does not change in order to refresh timestamps 
and keep time-sorted caches in the correct order.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Upon receiving a known hub list, the 
detailed hubs should be stored in appropriate data structures.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Neighbouring hubs must be retained in 
the hub cluster records, while cached hubs should be merged with the local 
accessible hub cache.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no payload at the current 
time.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has several child packet types 
defined at the current time:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l28 level1 lfo19"><SPAN 
  lang=EN-AU>/KHL/TS - Timestamp</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l28 level1 lfo19"><SPAN 
  lang=EN-AU>/KHL/NH – Neighbouring Hub</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l28 level1 lfo19"><SPAN 
  lang=EN-AU>/KHL/CH – Cached Hub</SPAN> </LI></UL>
<H2><A name=_Toc36412944><SPAN lang=EN-AU>/KHL/TS – Timestamp</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /KHL/TS child provides a timestamp 
representing the current universal time at the sending node.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>This can be used as a reference when 
considering other timestamps in the packet, allowing them to be adjusted to 
eliminate differences between the time setting on the local and remote 
node.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is optional but 
recommended.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload<o:p></o:p></SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A 32-bit integer representing the current 
UNIX time, or time (NULL).</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.</SPAN></P>
<H2><A name=_Toc36412945><SPAN lang=EN-AU>/KHL/NH – Neighbouring 
Hub</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child packet represents a neighbouring 
hub.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>One should be included for each Gnutella2 
neighbour hub, with the possible exception of the one to which this packet is 
being sent.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The node address of the hub.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>See datatypes for more 
information.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has several child packet types 
defined at the current time:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l15 level1 lfo20"><SPAN 
  lang=EN-AU>/KHL/NH/GU - GUID<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l15 level1 lfo20"><SPAN 
  lang=EN-AU>/KHL/NH/V – Vendor Code</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l15 level1 lfo20"><SPAN 
  lang=EN-AU>/KHL/NH/LS – Library Statistics</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l15 level1 lfo20"><SPAN 
  lang=EN-AU>/KHL/NH/HS – Hub Status</SPAN> </LI></UL>
<H2><A name=_Toc36412946><SPAN lang=EN-AU>/KHL/NH/GU – GUID</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /KHL/NH/GU child packet specifies the 
globally unique identifier of the hub.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is optional.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload<o:p></o:p></SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The 16 byte globally unique node identifier 
of the hub. </SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412947><SPAN lang=EN-AU>/KHL/NH/V – Vendor 
Code</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /KHL/NH/V child packet specifies the 
vendor code of the software operating the hub.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is optional.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A four byte vendor code.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412948><SPAN lang=EN-AU>/KHL/NH/LS – Library 
Statistics</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /KHL/NH/LS packet provides information 
about the content library of the hub and its connected leaves.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is optional.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload<o:p></o:p></SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Two 32-bit integers representing the number 
of files, and the total KB of available content in the hub’s own library and the 
libraries of its connected leaves.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>The payload may grow beyond 8 bytes in the future.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412949><SPAN lang=EN-AU>/KHL/NH/HS – Hub 
Status</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /KHL/NH/HS packet contains the status of 
the hub.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is optional.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Two 16-bit integers representing the current 
leaf count and the maximum leaf count respectively.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>This packet may grow beyond 4 bytes in 
the future.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412950><SPAN lang=EN-AU>/KHL/CH – Cached Hub</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview<o:p></o:p></SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child packet represents a hub from the 
hub cache.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>An arbitrary number of these children should 
be included, constrained by space and the number of available cached hubs.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>A selection of freshly time stamped but 
previously unknown hubs should be included, and the list should not include hubs 
in the local cluster.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload<o:p></o:p></SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The node address of the hub, followed by the 
time this hub was last seen as a 32-bit timestamp.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>The last seen time can be adjusted based 
on the difference between the /KHL/TS timestamp and the local time.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Note that the node address is of 
variable length, so it is important to consider the last 4 bytes as the 
timestamp rather than assuming a fixed length node address.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has several child packet types 
defined at the current time:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l15 level1 lfo20"><SPAN 
  lang=EN-AU>/KHL/CH/GU - GUID<o:p></o:p></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l15 level1 lfo20"><SPAN 
  lang=EN-AU>/KHL/CH/V – Vendor Code</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l15 level1 lfo20"><SPAN 
  lang=EN-AU>/KHL/CH/LS – Library Statistics</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l15 level1 lfo20"><SPAN 
  lang=EN-AU>/KHL/CH/HS – Hub Status</SPAN> </LI></UL>
<P class=MsoNormal><SPAN lang=EN-AU>This extra information is considered less 
relevant for a cached hub because it is unlikely to be up to date enough to be 
useful.</SPAN></P>
<H2><A name=_Toc36412951><SPAN lang=EN-AU>/KHL/CH/GU – GUID</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /KHL/CH/GU child packet specifies the 
globally unique identifier of the hub.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is optional.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload<o:p></o:p></SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The 16 byte globally unique node identifier 
of the hub. </SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412952><SPAN lang=EN-AU>/KHL/CH/V – Vendor 
Code</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /KHL/CH/V child packet specifies the 
vendor code of the software operating the hub.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is optional.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A four byte vendor code.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412953><SPAN lang=EN-AU>/KHL/CH/LS – Library 
Statistics</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /KHL/NH/LS packet provides information 
about the content library of the hub and its connected leaves.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is optional.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload<o:p></o:p></SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Two 32-bit integers representing the number 
of files, and the total KB of available content in the hub’s own library and the 
libraries of its connected leaves.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>The payload may grow beyond 8 bytes in the future.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412954><SPAN lang=EN-AU>/KHL/CH/HS – Hub 
Status</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /KHL/CH/HS packet contains the status of 
the hub.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is optional.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Two 16-bit integers representing the current 
leaf count and the maximum leaf count respectively.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>This packet may grow beyond 4 bytes in 
the future.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36412955><SPAN lang=EN-AU>Known Hub Cache and Hub Cluster 
Cache</SPAN></A></H1></DIV>
<H2><A name=_Toc36412956><SPAN lang=EN-AU>Introduction</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Each Gnutella2 node must maintain a 
non-exhaustive cache of known hubs at the global level, and an exhaustive cache 
of hubs within the neighbouring hub cluster(s).</SPAN></P>
<H2><A name=_Toc36412957><SPAN lang=EN-AU>The Known Hub Cache</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The known hub list is used to provide 
connection hints to the local connection manager, and other nodes which connect 
permanently or transiently.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The 
most recent portion of it is exchanged with neighbours regularly.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>It is also used when executing a query on 
the network, which involves iteratively contacting hubs representing each hub 
cluster and simultaneously recording the hubs which have been accounted for and 
adding those newly discovered.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The known hub cache should be highly 
efficient, addressable by node address and timestamp, and sorted by the last 
seen timestamp of each hub record.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>Adding fresh hubs should push the oldest hubs from the bottom of the 
cache.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>It is suggested that each cached hub entry 
store:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l17 level1 lfo21"><SPAN 
  lang=EN-AU>Node address</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l17 level1 lfo21"><SPAN 
  lang=EN-AU>Last seen time</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l17 level1 lfo21"><SPAN 
  lang=EN-AU>Query key, if available</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l17 level1 lfo21"><SPAN 
  lang=EN-AU>GUID, if available</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l17 level1 lfo21"><SPAN 
  lang=EN-AU>Vendor information, if desired and available</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l17 level1 lfo21"><SPAN 
  lang=EN-AU>Throttling timing for last query key request, last query, 
  etc</SPAN> </LI></UL>
<P class=MsoNormal><SPAN lang=EN-AU>Hubs whose last seen timestamp is too old 
should be removed from the cache, and should certainly never be sent to other 
nodes.</SPAN></P>
<H2><A name=_Toc36412958><SPAN lang=EN-AU>The Hub Cluster Cache</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The hub cluster cache is used to maintain an 
up to date list of neighbouring hubs, and the neighbouring hubs of neighbouring 
hubs.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Thinking in terms of hops, it 
is an exhaustive list of every hub which is 1 or 2 hops away from the local node 
(be the local node a hub or a leaf).<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>The cluster cache is really only important when operating in hub mode, 
however it can be maintained in leaf mode for informational purposes.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The hub cluster cache is used by a hub when 
responding to a keyed remote query request, in the generation of a query 
acknowledgement packet (/QA).<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The 
/QA packet contains a list of neighbouring hubs and a selection of second degree 
neighbours.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The cluster cache is updated using 
information from /LNI and /KHL packets.</SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36412959><SPAN lang=EN-AU>Node Route Cache and Addressed Packet 
Forwarding</SPAN></A></H1></DIV>
<H2><A name=_Toc36412960><SPAN lang=EN-AU>Introduction</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Each Gnutella2 node must maintain a dynamic 
node route cache to map node GUIDs to appropriate destinations.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>The route cache is consulted when a 
packet needs to be dispatched to or toward a GUID-addressed node.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>GUID-addressing is used over 
network-addressing in a number of situations.</SPAN></P>
<H2><A name=_Toc36412961><SPAN lang=EN-AU>Data</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Each entry in a node route cache will 
have:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l49 level1 lfo22"><SPAN 
  lang=EN-AU>The GUID of the target node</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l49 level1 lfo22"><SPAN 
  lang=EN-AU>The local TCP connection providing the best route to the node, 
  or</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l49 level1 lfo22"><SPAN lang=EN-AU>A 
  UDP endpoint for the node or the best route to the node</SPAN> </LI></UL>
<H2><A name=_Toc36412962><SPAN lang=EN-AU>Performance</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>A route cache needs to be addressable by 
GUID, and must implement a refresh mechanism to store routes for an appropriate 
amount of time based upon route hits.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>Many schemes exist to engineer efficient lookup systems, such as hash 
tables, two-table exchanges and balanced trees.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The route cache is similar to the several 
GUID mapping caches involved in old Gnutella applications, with two key 
differences:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l45 level1 lfo23"><SPAN 
  lang=EN-AU>Each entry may map to a local address <B 
  style="mso-bidi-font-weight: normal">or</B> a UDP endpoint</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l45 level1 lfo23"><SPAN 
  lang=EN-AU>There is only one unified route cache for all purposes</SPAN> 
</LI></UL>
<H2><A name=_Toc36412963><SPAN lang=EN-AU>Applications</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>GUIDs are used to identify virtual entities 
within the network, such as nodes (node GUIDs), searches (search GUIDs) and 
other transactional requests.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The 
GUIDs associated with these entities can then be committed to the route cache 
and mapped to reflect the easiest route back to the owner of the 
object.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>All nodes should be aware of their directly 
connected neighbours, and treat these node GUIDs as a special case that need 
never expire.</SPAN></P>
<H2><A name=_Toc36412964><SPAN lang=EN-AU>Addressed Packet 
Forwarding</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Any Gnutella2 packet may be addressed to a 
particular destination node by GUID.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>Upon receiving an addressed packet, it should be immediately forwarded 
either to the destination, or toward it.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>Addressed packets should not be interpreted locally unless the 
destination address matches the local GUID.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Loops are avoided by placing restrictions 
upon forwarding:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l34 level1 lfo24"><SPAN lang=EN-AU>If 
  received from a leaf via TCP, a packet may be forwarded anywhere</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l34 level1 lfo24"><SPAN lang=EN-AU>If 
  received from a hub, a packet may only be forwarded to a leaf</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l34 level1 lfo24"><SPAN lang=EN-AU>If 
  received via UDP, a packet may not be forwarded via UDP</SPAN> </LI></UL>
<P class=MsoNormal><SPAN lang=EN-AU>Note that these restrictions apply only to 
generically addressed packets.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Some 
packet types have specific forwarding rules which override these.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>These rules allow any node to be reached 
in two hops.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Packets are addressed by including a special 
child packet as the first child of the root packet.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>The child packet is named “TO”, so its 
full name would be “/?/TO” where ? <SPAN class=GramE>is</SPAN> the root packet 
name.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The address packet’s payload 
consists of a 16 byte GUID, and it has no children defined at the current 
time.</SPAN></P>
<H2><A name=_Toc36412965><SPAN lang=EN-AU>Reverse Connection (Push) 
Requests</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Addressed packet forwarding can be used to 
deliver any valid Gnutella2 communications to leaf nodes that are unable to 
accept TCP or UDP traffic directly.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>The packet is simply sent to one of the hubs to which the target leaf is 
attached, or a hub in the same hub cluster, and the forwarding rules will allow 
the packet to reach its destination.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>This mechanism is used to request that a 
“firewalled” leaf initiate a “reverse connection” or “call-back” to an elected 
address.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The root packet type 
“/PUSH” is used, and is documented in the following sections.</SPAN></P>
<H2><A name=_Toc36412966><SPAN lang=EN-AU>/PUSH – Push / Connect Back 
Request</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The push packet is used to request that a 
node initiate a TCP connection to a specified node address.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It is useful where the receiving node is 
unable to accept TCP connections naturally.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>An addressed /PUSH packet should be sent to 
a hub with direct or proxy access to the destination leaf node.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It can be sent directly by a hub to one 
of its leaves without the need for addressing.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Upon receiving a /PUSH packet, the local 
node should initiate a TCP connection to the elected node address and issue a 
“push handshake”, documented below.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The network address of the node to contact, 
including of course the port number.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time, however it is often used with the generic addressing child packet 
“/?/TO” to indicate that it should be forwarded to a 
destination.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412967><SPAN lang=EN-AU>Push Handshaking</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The Gnutella2 push handshake is very simple 
– it simply identifies the connection as originating from a push, and provides 
the GUID of the initiating node:</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>PUSH guid:GUIDinHEXguidINhexGUIDinHEXguidI<SPAN 
style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; </SPAN>(\r\n)</SPAN></P>
<P class=Code><SPAN lang=EN-AU>(\r\n)</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Note that unlike the Gnutella1 case, no 
purpose-specific information is provided.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>The pushed connection can now be used for any purpose a normally 
established TCP link could adopt, including but not limited to:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l40 level1 lfo25"><SPAN 
  lang=EN-AU>Gnutella2 network connection</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l40 level1 lfo25"><SPAN 
  lang=EN-AU>Data transfer</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l40 level1 lfo25"><SPAN 
  lang=EN-AU>Personal communications</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l40 level1 lfo25"><SPAN 
  lang=EN-AU>Etc</SPAN> </LI></UL>
<P class=MsoNormal><SPAN lang=EN-AU>Gnutella2 implementations are however 
strongly advised to provide backward support for the Gnutella1 push handshake, 
even if not supporting Gnutella1 directly.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>This is because applications supporting both protocols may be unable to 
determine in advance whether the host they are pushing to is Gnutella1 or 
Gnutella2.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The legacy-style push handshake looks 
like:</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>GIV 0:GUIDinHEXguidINhexGUIDinHEXguidI/<SPAN 
style="mso-tab-count: 1"> </SPAN>(\n\n)</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The leading zero and trailing slash have 
task-specific meanings in Gnutella1; however Gnutella2 applications can safely 
ignore them and consider only the GUID.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>Be sure to allow for variable length handshakes, however.</SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36412968><SPAN lang=EN-AU>Query Hash Tables, Superset Table and 
Exchange</SPAN></A></H1></DIV>
<H2><A name=_Toc36412969><SPAN lang=EN-AU>Introduction</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Building an efficient network topology is 
not viable without means to restrict the flow of information appropriately.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>In the Gnutella2 network architecture, 
neighbouring nodes exchange compressed hash filter tables describing the content 
which can be reached by communicating with them.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>These tables are updated dynamically as 
necessary.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The concept of filtering hash tables in file 
sharing was pioneered by Limegroup for the LimeWire Gnutella1 
application.</SPAN></P>
<H2><A name=_Toc36412970><SPAN lang=EN-AU>Table Properties</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Query hash tables or QHTs provide enough 
information to know with certainty that a particular node (and possibly its 
descendants) will <B style="mso-bidi-font-weight: normal">not</B> be able to 
provide any matching objects for a given query.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Conversely the QHT may reveal that a 
node or its descendants <B style="mso-bidi-font-weight: normal">may</B> be able 
to provide matching objects.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>This property means that queries can be 
discarded confidently when a transmission is known to be unnecessary, while not 
providing the filtering or forwarding node any actual information about the 
searchable content.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Neighbours know 
what their neighbours do not have, but cannot say for sure what they do 
have.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>QHTs are also very efficient 
both in terms of exchange and maintenance and lookup cost.</SPAN></P>
<H2><A name=_Toc36412971><SPAN lang=EN-AU>Table Content</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>A QHT is a table of 2^N bits, where each bit 
represents a unique word-hash value.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>For example a table of 20 bits has 2^20 = 1048576 possible word-hash 
values.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If stored uncompressed this 
table would be 128 KB in size.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>In an empty table, every word-hash value bit 
will be “1”, which represents “empty”.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>To populate the table with searchable content, an application 
must:</SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 39.3pt; TEXT-INDENT: -18pt; tab-stops: list 39.3pt; mso-list: l31 level1 lfo26"><![if !supportLists]><SPAN 
lang=EN-AU 
style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN 
style="mso-list: Ignore">·<SPAN 
style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><![endif]><SPAN lang=EN-AU>Locate every plain-text word and 
URN which could be searched for and produce a match/hit</SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 39.3pt; TEXT-INDENT: -18pt; tab-stops: list 39.3pt; mso-list: l31 level1 lfo26"><![if !supportLists]><SPAN 
lang=EN-AU 
style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN 
style="mso-list: Ignore">·<SPAN 
style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><![endif]><SPAN lang=EN-AU>Hash the word with a simple hash 
function to produce a word-hash value which is 0 &lt;= value &lt; 
(2^N).</SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 39.3pt; TEXT-INDENT: -18pt; tab-stops: list 39.3pt; mso-list: l31 level1 lfo26"><![if !supportLists]><SPAN 
lang=EN-AU 
style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN 
style="mso-list: Ignore">·<SPAN 
style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><![endif]><SPAN lang=EN-AU>Set the appropriate bit in the 
table to zero, representing “full”.</SPAN></P>
<H2><A name=_Toc36412972><SPAN lang=EN-AU>Word Hashing</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Words are strings of one or more 
alphanumeric characters which are not all numeric.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>To convert a word into a hash value, the 
following case-insensitive algorithm is used:</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>// HashWord( string_ptr, char_count, 
table_bit_count );</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>DWORD CQueryHashTable::HashWord(LPCTSTR psz, int 
nLength, int nBits)</SPAN></P>
<P class=Code><SPAN lang=EN-AU>{</SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; 
</SPAN>DWORD nNumber<SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>= 0;</SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; 
</SPAN>int nByte<SPAN 
style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>= 0;</SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; 
</SPAN>for ( ; nLength &gt; 0 ; nLength--, psz++ )</SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; 
</SPAN>{</SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN 
style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>int nValue = tolower( *psz ) &amp; 0xFF; </SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN 
style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>nValue = nValue &lt;&lt; ( nByte * 8 );</SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN 
style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>nByte = ( nByte + 1 ) &amp; 3;</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN 
style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>nNumber = nNumber ^ nValue;</SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; 
</SPAN>}</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; 
</SPAN>return HashNumber( nNumber, nBits );</SPAN></P>
<P class=Code><SPAN lang=EN-AU>}</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>DWORD CQueryHashTable::HashNumber(DWORD nNumber, 
int nBits)</SPAN></P>
<P class=Code><SPAN lang=EN-AU>{</SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; 
</SPAN>WORD64 nProduct = (WORD64)nNumber * (WORD64)0x4F1BBCDC;</SPAN></P>
<P class=Code style="TEXT-INDENT: 21.8pt"><SPAN lang=EN-AU>WORD64 nHash = ( 
nProduct &lt;&lt; 32 ) &gt;&gt; ( 32 + ( 32 - nBits ) );</SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; 
</SPAN>return (DWORD)nHash;</SPAN></P>
<P class=Code><SPAN lang=EN-AU>}</SPAN></P>
<H2><A name=_Toc36412973><SPAN lang=EN-AU>URNs – A Special Case</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>URNs are treated as a special case: rather 
than dividing them up into word tokens, they are hashed as a complete fixed 
length string.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>For 
example:</SPAN></P>
<P class=Code><SPAN 
lang=EN-AU>urn:sha1:WIXYJFVJMIWNMUWPRPBGUTODIV52RMJA</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU style="mso-no-proof: yes">Bitprint URNs are 
actually composite values which include both a SHA1 and TigerTree root 
value.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Rather than adding the whole 
bitprint to the table, each of the constituent URNs are added separately.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>This allows SHA1-only querying and 
tiger-only querying.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>A root 
TigerTree URN takes the form:<o:p></o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN 
lang=EN-AU>urn:tree:tiger/:CN25MLNU3XNN7IHKZMNOA63XG6SKDJ2W7Z3HONA</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU style="mso-no-proof: yes">Other URNs should 
be expressed in their most natural form before being fed to the word hash 
function.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412974><SPAN lang=EN-AU style="mso-no-proof: yes">Word Prefix 
Extensions</SPAN></A><SPAN lang=EN-AU 
style="mso-no-proof: yes"><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>For words consisting of at least five 
characters, it is often useful to be able to match substrings within the 
word.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Unfortunately adding every 
possible substring of each word would increase the density of the QHT, however a 
simple and effective compromise is available:</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>For words with 5 or more 
characters:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l11 level1 lfo46"><SPAN 
  lang=EN-AU>Hash and add the whole word</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l11 level1 lfo46"><SPAN 
  lang=EN-AU>Hash and add the whole world minus the last character</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l11 level1 lfo46"><SPAN 
  lang=EN-AU>Hash and add the whole world minus the last two characters</SPAN> 
  </LI></UL>
<P class=MsoNormal><SPAN lang=EN-AU>This allows searching on prefixes of the 
word, for example “match” will now match “matches”.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412975><SPAN lang=EN-AU>Table Exchange</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Nodes must keep their neighbouring hubs up 
to date with their latest local query hash table at all times.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Rather than sending the whole table 
whenever it changes, nodes may opt to send a “table patch”, which includes only 
the difference between the old and new table.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The /QHT packet is used to supply a query 
hash table update to a neighbouring hub.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>Its format is compatible with the Gnutella1 “query routing protocol”, 
except that Gnutella2 requires a 1-bit per value table while Gnutella1 requires 
a 4 or 8 bit per value table.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>Gnutella2 supports patch compression using the deflate algorithm, however 
this should not be applied if the TCP link itself is compressed.</SPAN></P>
<H2><A name=_Toc36412976><SPAN lang=EN-AU>/QHT – Query Hash 
Table</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The query hash table update packet supplies 
an update to the query hash table for the sending node.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It supports two operations: clear 
existing table, and patch existing table with new data.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /QHT packet should be sent when the 
local or aggregate query hash table has changed.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Upon receiving a /QHT packet, the local hub 
should patch the query hash table for the connection on which the packet was 
received.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If the connection is to a 
leaf node, the hub should update its aggregate table and queue a propagation of 
that table to neighbouring hubs in the cluster.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The payload is of the same format as 
Gnutella1’s “query routing protocol” message:</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The first byte is a command byte, 0x00 
indicates a reset command, while 0x01 indicates a patch command.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload – Reset</SPAN></H3>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>typedef struct</SPAN></P>
<P class=Code><SPAN lang=EN-AU>{</SPAN></P>
<P class=Code style="TEXT-INDENT: 21.8pt"><SPAN lang=EN-AU>BYTE<SPAN 
style="mso-tab-count: 1">&nbsp; </SPAN>command;<SPAN 
style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>// = 0 (reset)<BR><SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; 
</SPAN>LONG<SPAN style="mso-tab-count: 1">&nbsp; 
</SPAN>table_size_in_entries;<SPAN style="mso-tab-count: 1">&nbsp; </SPAN>// = 
2^(size_in_bits)</SPAN></P>
<P class=Code><SPAN lang=EN-AU><SPAN style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; 
</SPAN>BYTE<SPAN style="mso-tab-count: 1">&nbsp; </SPAN>infinity;<SPAN 
style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>// = 1</SPAN></P>
<P class=Code><SPAN lang=EN-AU>} QHT_RESET;</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>A reset packet establishes a new table and 
clears it (replacing any existing table).<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>In Gnutella2 the value of infinity must always be 1.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Note that the table size is measured in 
entries rather than bits, so it is equal to 2^N where N is the number of 
bits.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload – Patch</SPAN></H3>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>typedef struct</SPAN></P>
<P class=Code><SPAN lang=EN-AU>{</SPAN></P>
<P class=Code style="TEXT-INDENT: 21.8pt"><SPAN lang=EN-AU>BYTE<SPAN 
style="mso-tab-count: 1">&nbsp; </SPAN>command;<SPAN 
style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>// = 1 (patch)</SPAN></P>
<P class=Code style="TEXT-INDENT: 21.8pt"><SPAN lang=EN-AU>BYTE<SPAN 
style="mso-tab-count: 1">&nbsp; </SPAN>fragment_no;<SPAN 
style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>// = number of 
this patch fragment</SPAN></P>
<P class=Code style="TEXT-INDENT: 21.8pt"><SPAN lang=EN-AU>BYTE<SPAN 
style="mso-tab-count: 1">&nbsp; </SPAN>fragment_count;<SPAN 
style="mso-tab-count: 1">&nbsp;&nbsp; </SPAN>// = number of patch 
fragments</SPAN></P>
<P class=Code style="TEXT-INDENT: 21.8pt"><SPAN lang=EN-AU>BYTE<SPAN 
style="mso-tab-count: 1">&nbsp; </SPAN>compression;<SPAN 
style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>// = 0 for none, 
= 1 for deflate</SPAN></P>
<P class=Code style="TEXT-INDENT: 21.8pt"><SPAN lang=EN-AU>BYTE<SPAN 
style="mso-tab-count: 1">&nbsp; </SPAN>bits;<SPAN 
style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>// = 1 for Gnutella2</SPAN></P>
<P class=Code style="TEXT-INDENT: 21.8pt"><SPAN lang=EN-AU>(data)<BR>} 
QHT_PATCH;</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Patches may be fragmented into more than one 
packet if necessary, in which case the fragment number and count fields are used 
to reassemble the patch.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Note that 
fragments must be sent in correct order.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Patches may be compressed – in this case the 
whole patch is compressed, rather than compressing fragments individually.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>One compression type is defined, deflate 
compression.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Gnutella2 always uses tables with 1 bit per 
entry, so the bit count must be 1.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The patch data in uncompressed form is of 
(2^N)/8 bytes length, where N is the table bit size.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>This is exactly the same size as the 
table which is being patched.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>To 
apply the patch, simply XOR the existing table with the patch data.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>In other words, whenever there is a 1 
bit, the bit in the existing table is toggled.</SPAN></P>
<H2><A name=_Toc36412977><SPAN lang=EN-AU>Table Access</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>A table of 2^N bits can be stored in an 
array of bytes (2^N)/8 long.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>To 
resolve a hash-value into a byte and bit number, use the following 
equations:</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>int nByte<SPAN style="mso-tab-count: 1"> </SPAN>= 
( nHashValue &gt;&gt; 3 );</SPAN></P>
<P class=Code><SPAN lang=EN-AU>int nBit<SPAN style="mso-tab-count: 1">&nbsp; 
</SPAN>= ( nHashValue &amp; 7 );</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The least significant bit is numbered 0; the 
most significant bit is numbered 7.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>To set a bit as empty (setting it to 1):</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>table_ptr[ nByte ] |= ( 1 &lt;&lt; nBit 
);</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>To set a bit as full (setting it to 
zero):</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>table_ptr[ nByte ] &amp;= ~( 1 &lt;&lt; nBit 
);</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<H2><A name=_Toc36412978><SPAN lang=EN-AU>The Aggregate or Superset 
Table</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Nodes operating in hub mode must maintain an 
aggregate or superset query hash table, consisting of their own searchable 
content combined with the QHTs supplied by all connected leaves.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>This aggregate table is supplied to 
neighbouring hubs, allowing them to completely filter traffic for the local hub 
and its leaves.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>This has two important 
implications:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l43 level1 lfo27"><SPAN 
  lang=EN-AU>When a change is detected in either the local content or a 
  connected leaf node’s QHT, the aggregate table must be rebuilt and patches 
  dispatched to neighbouring hubs.<SPAN style="mso-spacerun: yes">&nbsp; 
  </SPAN>This will happen often, so an appropriate minimum time between updates 
  should be used.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>One minute is 
  effective.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l43 level1 lfo27"><SPAN lang=EN-AU>An 
  aggregate table representing 400 leaves will be much denser than a table 
  representing one node.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>This means 
  that <B style="mso-bidi-font-weight: normal">all tables</B> must be large 
  enough that the aggregate table remains productively sparse.</SPAN> </LI></UL>
<P class=MsoNormal><SPAN lang=EN-AU>To create an aggregate table, start with an 
empty table of fixed size containing all 1’s.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>For each contributing table, copy any 
zero (full) bits to the aggregate table.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>This is effectively an AND operation.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>If a source table is smaller than the 
aggregate table, a single 0 bit in the source will equate to several zero bits 
in the aggregate.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If the source 
table is larger than the aggregate table, a single zero bit will map to a single 
bit with some loss of accuracy.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>It is of great importance that all QHTs in 
the system be sufficiently large to allow an aggregate table to remain suitable 
sparse.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Ideally each leaf node 
should provide a table less than 1% dense.</SPAN></P>
<H2><A name=_Toc36412979><SPAN lang=EN-AU>Query Filtering</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Before transmitting a query packet to a 
connection that has provided a query hash table, match the words and URNs in the 
query against the QHT.</SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 39.3pt; TEXT-INDENT: -18pt; tab-stops: list 39.3pt; mso-list: l10 level1 lfo28"><![if !supportLists]><SPAN 
lang=EN-AU 
style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN 
style="mso-list: Ignore">·<SPAN 
style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><![endif]><SPAN lang=EN-AU>If any of the lookups based on 
URNs found a hit, send the query packet</SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 39.3pt; TEXT-INDENT: -18pt; tab-stops: list 39.3pt; mso-list: l10 level1 lfo28"><![if !supportLists]><SPAN 
lang=EN-AU 
style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN 
style="mso-list: Ignore">·<SPAN 
style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><![endif]><SPAN lang=EN-AU>If at least two thirds of 
lookups based on words found a hit, send</SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 39.3pt; TEXT-INDENT: -18pt; tab-stops: list 39.3pt; mso-list: l10 level1 lfo28"><![if !supportLists]><SPAN 
lang=EN-AU 
style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN 
style="mso-list: Ignore">·<SPAN 
style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><![endif]><SPAN lang=EN-AU>Otherwise, drop the 
packet</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>It is important to apply the “two thirds” 
rule only for words.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>URNs must 
provide an automatic match.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Consider all text content in the query, 
including generic search text and metadata search text if it is present.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>When dealing with simple query language 
that involves quoted phrases and exclusions, apply the following 
rules:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l26 level1 lfo29"><SPAN 
  lang=EN-AU>Tokenize quoted phrases into words, ignoring the phrase at this 
  level</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l26 level1 lfo29"><SPAN 
  lang=EN-AU>Ignore excluded words – these do not count as table hits or 
  misses</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l26 level1 lfo29"><SPAN 
  lang=EN-AU>Remember to apply exclusion to every word in an excluded 
  phrase</SPAN> </LI></UL>
<P class=MsoNormal><SPAN lang=EN-AU>See the section on the simple query language 
for more information.<o:p></o:p></SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36412980><SPAN lang=EN-AU>Gnutella2 Object Search 
Mechanism</SPAN></A></H1></DIV>
<H2><A name=_Toc36412981><SPAN lang=EN-AU>Introduction</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The distributed object search mechanism is a 
very important component of the Gnutella2 architecture.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It allows objects distributed throughout 
the network to be located by a search client in an optimal fashion, requesting 
and receiving a subset of the total information known about that 
object.</SPAN></P>
<H2><A name=_Toc36412982><SPAN lang=EN-AU>Model</SPAN></A><SPAN 
lang=EN-AU><o:p></o:p></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The Gnutella2 object search mechanism is 
best described as an “iterative crawl” of the network, with a series of 
important optimisations derived from the network topology and 
components:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l29 level1 lfo30"><SPAN lang=EN-AU>A 
  search client iteratively contacts known hubs with its query</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l29 level1 lfo30"><SPAN 
  lang=EN-AU>Hubs match the query against the cached hash tables of their 
  neighbours</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l29 level1 lfo30"><SPAN 
  lang=EN-AU>Where a table hit occurs, the query is forwarded once only</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l29 level1 lfo30"><SPAN 
  lang=EN-AU>The single injected query thus effectively covers the logical hub 
  cluster, which is the basic searchable unit</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l29 level1 lfo30"><SPAN 
  lang=EN-AU>Nodes which actually receive the filtered query process it and send 
  results to the search client directly</SPAN> </LI></UL>
<P class=MsoNormal><SPAN lang=EN-AU>This model has a number of important 
advantages:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l22 level1 lfo31"><SPAN 
  lang=EN-AU>Wide network coverage is provided by iterative query 
  injection</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l22 level1 lfo31"><SPAN 
  lang=EN-AU>Effective leaf density is increased by querying hub clusters rather 
  than single hubs or even single nodes</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l22 level1 lfo31"><SPAN 
  lang=EN-AU>Mutual and two-level filtering and static link compression are 
  leveraged</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l22 level1 lfo31"><SPAN 
  lang=EN-AU>The load on each hub cluster is spread equally between its member 
  hubs, providing a larger search base with a lower cost on the aggregation 
  points</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l22 level1 lfo31"><SPAN 
  lang=EN-AU>Hubs need a greater inbound bandwidth capacity than outbound 
  bandwidth capacity, which ideally suits asymmetric Internet connections</SPAN> 
  </LI></UL>
<H2><A name=_Toc36412983><SPAN lang=EN-AU>Search Process 
Walkthrough</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>When a search client wishes to execute a new 
search, the following events happen:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l58 level1 lfo32"><SPAN 
  lang=EN-AU>The search client selects an eligible hub from its global hub cache 
  which has a recent timestamp, has not been contacted more recently than it 
  allows, and has not yet been queried in this search.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l58 level1 lfo32"><SPAN lang=EN-AU>If 
  a query key is not yet available for this hub, a query key request is 
  dispatched.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l58 level1 lfo32"><SPAN 
  lang=EN-AU>Once a query key is available, the search client sends a keyed 
  query to the hub.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l58 level1 lfo32"><SPAN 
  lang=EN-AU>Upon receiving the query, the hub checks the query key for 
  validity.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l58 level1 lfo32"><SPAN 
  lang=EN-AU>The hub then responds with a query acknowledgement packet, 
  containing a list of neighbouring hubs which have now been searched and a list 
  of 2-hop hubs which have not yet been searched.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l58 level1 lfo32"><SPAN 
  lang=EN-AU>The search client adds the list of searched hubs to its “don’t try 
  again” list, and adds the list of “try hubs” to the global hub cache for 
  future selection.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l58 level1 lfo32"><SPAN 
  lang=EN-AU>Meanwhile, the hub examines the query to make sure that it has not 
  received it before.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Duplicate 
  queries are dropped.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l58 level1 lfo32"><SPAN 
  lang=EN-AU>The hub then matches the query against the query hash table of all 
  connected nodes, and sends it to those nodes which may be able to field a 
  match.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l58 level1 lfo32"><SPAN 
  lang=EN-AU>While this is occurring, the hub processes the query locally and 
  returns any results it may have.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l58 level1 lfo32"><SPAN 
  lang=EN-AU>Leaves directly attached to the hub which have a potential match 
  will have received the query, and process it locally.<SPAN 
  style="mso-spacerun: yes">&nbsp; </SPAN>They may elect to return results 
  directly to the search client, or may return their results to their hub for 
  dispatch.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l58 level1 lfo32"><SPAN 
  lang=EN-AU>Other hubs in the hub cluster which received the query now examine 
  it to ensure they have not processed it before.<SPAN 
  style="mso-spacerun: yes">&nbsp; </SPAN>They do not send an 
  acknowledgement.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l58 level1 lfo32"><SPAN 
  lang=EN-AU>Assuming it is new, the hubs match the query against the query hash 
  tables of their leaves but not their neighbouring hubs.<SPAN 
  style="mso-spacerun: yes">&nbsp; </SPAN>Potential leaves receive a copy of the 
  query, and the hub processes it locally.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l58 level1 lfo32"><SPAN 
  lang=EN-AU>Once again, the hub returns its own results and may forward results 
  for its leaves if they do not wish to dispatch them directly.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l58 level1 lfo32"><SPAN 
  lang=EN-AU>Meanwhile, the search client receives any search results generated 
  by the hub cluster.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l58 level1 lfo32"><SPAN 
  lang=EN-AU>The search client makes a decision on whether it should continue 
  its search.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If so, the process 
  starts again.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l58 level1 lfo32"><SPAN 
  lang=EN-AU>The search client will not <SPAN class=SpellE>requery</SPAN> any of 
  the hubs in the hub cluster, but it has a list of nearby hubs so that the 
  crawl can continue.</SPAN> </LI></UL>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36412984><SPAN lang=EN-AU>Search Security</SPAN></A></H1></DIV>
<H2><A name=_Toc36412985><SPAN lang=EN-AU>Introduction</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>In an environment where a single query 
injection may result in a number of responses, acting as a virtual “traffic 
amplifier”, it is desirable to verify that the return address is indeed that of 
the original sender.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>This prevents 
the network from being used as a method of generating a large-scale traffic 
generator.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The Gnutella2 network uses a system of 
“query keys” to solve this problem.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Before a search client can transmit a query 
to a particular hub, it must obtain a “query key” for that hub and include it in 
the transmission.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Query keys are 
unique to the hub generating them and the return address with which they are 
associated and generally expire after a relatively long period of 
time.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Search clients request a query key by 
sending a query key request to a hub, which includes the intended return address 
for the key.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The hub generates a 
key unique to that return address and dispatches it there.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>This makes it impossible to get a query 
key for an IP which is not controlled, and prevents keys from being shared 
between two nodes (key stealing).</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>When receiving a query from a foreign node, 
Gntuella2 hubs check the query key against the one they have issued for the 
query’s requested return address and proceed only if there is a match.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>If and only if the query key matches 
will the query acknowledgement be sent, or the search processed locally and 
forwarded to local leaves and neighbouring hubs.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>This has several positive effects.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>If a query does not have a valid key for 
the receiving hub, it will not be processed and will thus not generate a traffic 
amplification effect which may be used in a denial of service attack on a third 
party host.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Secondly, the query key 
mechanism ensures that queries are only processed if they were transmitted from 
a host which has control over the host in the return address (in the normal 
case, this is the same host).<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>This 
means that flood control mechanisms can remain just as effective as in the TCP 
case.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Similarly, host blocking is 
possible as the original query source can be verified.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412986><SPAN lang=EN-AU>/QKR – Query Key 
Request</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The query key request asks a destination hub 
to provide a query key that the requesting node can use to securely perform 
queries.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>This mechanism ensures 
that the network cannot be used to direct unsolicited packets to external 
hosts.<o:p></o:p></SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A query key request should be sent to a hub 
via the connectionless transport if a key is not already available for that hub 
for the local node address, or if a previously acquired key no longer works or 
has expired.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>There is no reason to 
request a query key via a TCP link.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Upon receiving a query key request, a hub 
should respond with a query key answer (/QKA) packet if it is willing to supply 
a query key.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The answer packet 
should be dispatched to the return address indicated in the request packet only, 
and the allocated key should be locked to that address.</SPAN></P>
<H2><A name=_Toc36412987><SPAN lang=EN-AU>/QKR/RNA – Requesting Node 
Address</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A query key may be requested for a node 
address other than that of the sender, for example when a UDP-firewalled leaf 
node wishes to acquire a query key for a remote hub that it will route through a 
locally connected hub.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>In this case 
it must request a query key for the node address of a connected hub.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is required to ensure that the 
sender knows its address.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload<o:p></o:p></SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The network address of the requesting 
node.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>See datatypes for more 
information.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412988><SPAN lang=EN-AU>/QKA – Query Key 
Answer</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The query key answer packet is sent in 
response to a query key request or in the event that a query with an incorrect 
or omitted query key is received.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>It advises the receiver of the correct query key to be used when 
contacting the sending hub to execute a remote cluster 
query.<o:p></o:p></SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The query key answer packet should be sent 
by a hub when a query key has been requested.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It should contain a key unique to the 
local hub and the requesting node address supplied in the request, and should be 
sent to that address only.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The query key answer packet may also be sent 
upon receiving a query with a missing or invalid query key.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>In this case no query should be 
performed.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Upon receiving a query key answer packet, 
the supplied query key should be stored for later use.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>If the answer packet contains a sending 
node address (/QKA/SNA) child which does not match the local node address, it 
may be forwarded to a connected leaf node via TCP with a matching address.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>In the forwarding case, a query node 
address (/QKA/QNA) child is added prior to forwarding to retain the remote 
(queried) hub’s address.</SPAN></P>
<H2><A name=_Toc36412989><SPAN lang=EN-AU>/QKA/QK – Query Key</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /QKA/QK child contains the query key 
that was requested.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is required if a key is being 
issued.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Sending a /QKA without a 
/QKA/QK indicates that the hub does not wish to authorise the requesting node to 
query it or its cluster.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload<o:p></o:p></SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A 32-bit query key which is unique to the 
hub and the sending node address.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412990><SPAN lang=EN-AU>/QKA/SNA – Sending Node 
Address</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child specifies the node address for 
which the key has been issued.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>This 
is not necessarily the node that physically transmitted the key request or the 
query.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is required.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload<o:p></o:p></SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The node address (with port number optional) 
of the node which requested the query key.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412991><SPAN lang=EN-AU>/QKA/QNA – Queried Node 
Address</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>If this query key answer packet has been 
forwarded to a firewalled leaf from a connected hub, a /QKA/QNA child will have 
been added to indicate the address of the remote hub.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child should be added by a hub when 
relaying a received query key answer on to a leaf via TCP.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>If this child is present, the query key 
answer should be treated as if it originated from the stored address rather than 
the TCP neighbour.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload<o:p></o:p></SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The node address (with port number optional) 
of the remote hub.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36412992><SPAN lang=EN-AU>Search 
Descriptor</SPAN></A></H1></DIV>
<H2><A name=_Toc36412993><SPAN lang=EN-AU>Introduction</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The Gnutella2 object search mechanism 
defines a powerful query descriptor capable of specifying a number of different 
extensible search criteria, and requesting a subset of information about 
matching objects.</SPAN></P>
<H2><A name=_Toc36412994><SPAN lang=EN-AU>/Q2 – Gnutella2 Query</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /Q2 packet is the generic Gnutella2 
object query descriptor.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>It 
contains search criteria, identification, authentication, return addressing and 
the type of information the search client is interested in.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A node should send a /Q2 packet to another 
node when it wishes to execute a query on that node (and its searchable 
relations).</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>/Q2 packets should always be filtered 
against a query hash table if one is available for the outbound link.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Upon receiving a query, a node 
should:</SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 39.3pt; TEXT-INDENT: -18pt; tab-stops: list 39.3pt; mso-list: l37 level1 lfo34"><![if !supportLists]><SPAN 
lang=EN-AU 
style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN 
style="mso-list: Ignore">·<SPAN 
style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><![endif]><SPAN lang=EN-AU>Verify its 
authentication</SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 39.3pt; TEXT-INDENT: -18pt; tab-stops: list 39.3pt; mso-list: l37 level1 lfo34"><![if !supportLists]><SPAN 
lang=EN-AU 
style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN 
style="mso-list: Ignore">·<SPAN 
style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><![endif]><SPAN lang=EN-AU>Send an acknowledgment if it was 
not received from a hub</SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 39.3pt; TEXT-INDENT: -18pt; tab-stops: list 39.3pt; mso-list: l37 level1 lfo34"><![if !supportLists]><SPAN 
lang=EN-AU 
style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN 
style="mso-list: Ignore">·<SPAN 
style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><![endif]><SPAN lang=EN-AU>Forward it to connected nodes if 
necessary (detailed below)</SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 39.3pt; TEXT-INDENT: -18pt; tab-stops: list 39.3pt; mso-list: l37 level1 lfo34"><![if !supportLists]><SPAN 
lang=EN-AU 
style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN 
style="mso-list: Ignore">·<SPAN 
style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><![endif]><SPAN lang=EN-AU>Process it locally and dispatch 
results</SPAN></P>
<H3><SPAN lang=EN-AU>Forwarding</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Forwarding of /Q2 packets is achieved based 
on fixed rules:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l53 level1 lfo33"><SPAN lang=EN-AU>A 
  query received from a leaf or via UDP is forwarded to all connected 
  nodes</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l53 level1 lfo33"><SPAN lang=EN-AU>A 
  query received from a hub is forwarded to connected leaves only</SPAN> 
</LI></UL>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The payload of a /Q2 packet consists of a 
GUID which uniquely identifies the search operation.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has many defined child packet 
types at the current time:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l14 level1 lfo35"><SPAN 
  lang=EN-AU>UDP – Return Address and Authentication</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l14 level1 lfo35"><SPAN 
  lang=EN-AU>URN – Universal Resource Name</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l14 level1 lfo35"><SPAN lang=EN-AU>DN 
  – Descriptive Name (Generic) Criteria</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l14 level1 lfo35"><SPAN lang=EN-AU>MD 
  – Metadata Criteria</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l14 level1 lfo35"><SPAN 
  lang=EN-AU>SZR – Object Size Restriction Criteria</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l14 level1 lfo35"><SPAN lang=EN-AU>I 
  – Interest</SPAN> </LI></UL>
<H2><A name=_Toc36412995><SPAN lang=EN-AU>/Q2/UDP – Return Address and 
Authentication</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /Q2/UDP child packet specifies the 
return address to be used for all direct replies, and the query key 
authentication which authorises transmissions to this address.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>If the query key is invalid, the query 
should be discarded and a valid query key issued to the nominated address (if 
desired).</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is required if the query is to be 
delivered via UDP.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>It is optional 
if delivered via TCP: if not included, replies will be reverse forwarded via 
TCP.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>If this child is present, all replies should 
be directed to the nominated address.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>The query key should be verified before replying.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A network address (variable length) followed 
by a query key (fixed length of 32 bits).</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412996><SPAN lang=EN-AU>/Q2/URN – Universal Resource 
Name</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /Q2/URN child specifies an exact 
universal resource name which will match the query.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Rules:</SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 39.3pt; TEXT-INDENT: -18pt; tab-stops: list 39.3pt; mso-list: l20 level1 lfo36"><![if !supportLists]><SPAN 
lang=EN-AU 
style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN 
style="mso-list: Ignore">·<SPAN 
style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><![endif]><SPAN lang=EN-AU>If one or more URNs are present 
in a query, whether or not they are understood, matching must occur on URN only 
– other criteria should be ignored.</SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 39.3pt; TEXT-INDENT: -18pt; tab-stops: list 39.3pt; mso-list: l20 level1 lfo36"><![if !supportLists]><SPAN 
lang=EN-AU 
style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN 
style="mso-list: Ignore">·<SPAN 
style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><![endif]><SPAN lang=EN-AU>If multiple URNs are present, 
only one need match an object for it to be considered a match for the 
query.</SPAN></P>
<P class=MsoNormal 
style="MARGIN-LEFT: 39.3pt; TEXT-INDENT: -18pt; tab-stops: list 39.3pt; mso-list: l20 level1 lfo36"><![if !supportLists]><SPAN 
lang=EN-AU 
style="FONT-FAMILY: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol"><SPAN 
style="mso-list: Ignore">·<SPAN 
style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN></SPAN></SPAN><![endif]><SPAN lang=EN-AU>Following from the above, 
multiple URNs of the same family may be specified and match multiple objects 
(this allows a compound query for several known objects to be executed in one 
packet)</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child should be added if a specific URN 
is being sought.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A string identifying the URN families 
followed by the URN in either text or binary representation.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Text representations should always be 
8-bit so that they can be considered binary.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The following compact URN families are 
recognised:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l57 level1 lfo37"><B 
  style="mso-bidi-font-weight: normal"><SPAN lang=EN-AU>bitprint</SPAN></B><SPAN 
  lang=EN-AU> or <B style="mso-bidi-font-weight: normal">bp</B> – 20 bytes of 
  SHA1 followed by 24 bytes of tiger-tree root</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l57 level1 lfo37"><B 
  style="mso-bidi-font-weight: normal"><SPAN lang=EN-AU>sha1</SPAN></B><SPAN 
  lang=EN-AU> – 20 bytes of SHA1</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l57 level1 lfo37"><B 
  style="mso-bidi-font-weight: normal"><SPAN 
  lang=EN-AU>tree:tiger/</SPAN></B><SPAN lang=EN-AU> or <B 
  style="mso-bidi-font-weight: normal">ttr</B> – 24 bytes of tiger-tree 
  root</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l57 level1 lfo37"><B 
  style="mso-bidi-font-weight: normal"><SPAN lang=EN-AU>md5</SPAN></B><SPAN 
  lang=EN-AU> – 16 bytes of MD5<B 
  style="mso-bidi-font-weight: normal"><o:p></o:p></B></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l57 level1 lfo37"><B 
  style="mso-bidi-font-weight: normal"><SPAN lang=EN-AU>ed2k</SPAN></B><SPAN 
  lang=EN-AU> – 16 bytes of compound MD4 (ed2k style root hash)<B 
  style="mso-bidi-font-weight: normal"><o:p></o:p></B></SPAN> </LI></UL>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412997><SPAN lang=EN-AU>/Q2/DN – Descriptive Name (Generic) 
Criteria</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The descriptive name child provides generic 
query text to be used in matching objects.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A string in the simple query 
language.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412998><SPAN lang=EN-AU>/Q2/MD – Metadata 
Criteria</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The metadata child provides an XML document 
containing rich query information.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>The schema identified in the XML must match a metadata schema of 
prospective matching objects.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A string containing XML.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>The &lt;?xml?&gt; header is 
optional.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Standard plural/singular 
Gnutella metadata schemas are used, for example:</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;?xml version=”1.0”?&gt;</SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;applications 
xsi:noNamespaceSchemaLocation=”<A 
href="http://www.shareaza.com/schemas/application.xsd">http://www.shareaza.com/schemas/application.xsd</A>”&gt;</SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;application title=”Shareaza”/&gt;</SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;/applications&gt;</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>All string values are in simple query 
language, including XML attribute and element values.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36412999><SPAN lang=EN-AU>/Q2/SZR – Size Restriction 
Criteria</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The size restriction criteria specify a 
minimum and maximum size for matching objects.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Two 32 bit integers, a minimum size followed 
by a maximum size in bytes.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36413000><SPAN lang=EN-AU>/Q2/I – Interest</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The Interest packet advertises an interest 
in certain information classes, effectively filtering the information that will 
be returned about matching objects.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Send an interest packet to restrict the type 
of information that will be returned about matching objects.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>For example if querying only to find 
instances of a known object, advertise interest for “URL” only.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Omitting the interest packet produces a 
default set of response information.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>If an interest packet is received, only 
return the requested information types.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>If no interest packet is present, return all available information that 
is feasible.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Extensions may be 
withheld.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>An array of strings identifying information 
classes.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The following are 
defined:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l56 level1 lfo38"><SPAN 
  lang=EN-AU>URL – Locations where matching objects can be found</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l56 level1 lfo38"><SPAN lang=EN-AU>DN 
  – Descriptive names of matching objects</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l56 level1 lfo38"><SPAN lang=EN-AU>MD 
  – Full metadata of matching objects</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l56 level1 lfo38"><SPAN 
  lang=EN-AU>COM – User comments, ratings and reviews of matching objects</SPAN> 

  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l56 level1 lfo38"><SPAN 
  lang=EN-AU>PFS – Partially available objects</SPAN> </LI></UL>
<P class=MsoNormal><SPAN lang=EN-AU>Note that default URNs are always supplied 
and need not be requested.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36413001><SPAN lang=EN-AU>Search 
Acknowledgement</SPAN></A></H1></DIV>
<H2><A name=_Toc36413002><SPAN lang=EN-AU>Introduction</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>When a Gnutella2 hub receives a /Q2 query 
packet from a search client, it needs to provide the client with acknowledgement 
for several reasons:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l21 level1 lfo39"><SPAN lang=EN-AU>To 
  tell the search client that the query was accepted, and the hub is 
  alive</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l21 level1 lfo39"><SPAN lang=EN-AU>To 
  tell the search client which hubs have now effectively been queried 
  (effectively because the query has been tested against their hash tables, even 
  if this did not result in a forward and local process operation)</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l21 level1 lfo39"><SPAN lang=EN-AU>To 
  provide the search client with additional hubs to try if it wishes to 
  continue</SPAN> </LI></UL>
<H2><A name=_Toc36413003><SPAN lang=EN-AU>Contents</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>The compact query acknowledgement lists the 
hubs which have been queried, and provides some hubs which could be queried 
later.</SPAN></P>
<H2><A name=_Toc36413004><SPAN lang=EN-AU>/QA – Query 
Acknowledgement</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The query acknowledgement packet is used to 
inform a search client that a target hub has received its query and is 
processing it.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>It also provides 
information for the search client’s hub cache, expanding knowledge of the 
network and ensuring hubs are not searched more than once in a given 
query.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Send a query acknowledgement packet only 
when operating in hub mode, and only when the query was not received from a hub 
via a TCP link.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Acknowledgements 
should only be sent after verifying the query key authentication.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>When a query acknowledgement is received, 
update the local hub cache as necessary:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l52 level1 lfo40"><SPAN 
  lang=EN-AU>Hubs which have been searched should not be sent this query 
  again</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l52 level1 lfo40"><SPAN 
  lang=EN-AU>New suggested hubs should be added and refreshed</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l52 level1 lfo40"><SPAN 
  lang=EN-AU>Any “back-off” time should be recorded and honoured.</SPAN> 
</LI></UL>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A GUID identifying the query being 
acknowledged.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has several child packet types 
defined at the current time:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l44 level1 lfo41"><SPAN 
  lang=EN-AU>/QA/TS – Timestamp</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l44 level1 lfo41"><SPAN 
  lang=EN-AU>/QA/D – “Done” or Completed Hub</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l44 level1 lfo41"><SPAN 
  lang=EN-AU>/QA/S – “Search” or New Hub</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l44 level1 lfo41"><SPAN 
  lang=EN-AU>/QA/RA – Retry After</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l44 level1 lfo41"><SPAN 
  lang=EN-AU>/QA/FR – From Address</SPAN> </LI></UL>
<H2><A name=_Toc36413005><SPAN lang=EN-AU>/QA/TS – Timestamp</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /QA/TS child provides a timestamp 
representing the current universal time at the sending node.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>This can be used as a reference when 
considering other timestamps in the packet, allowing them to be adjusted to 
eliminate differences between the time setting on the local and remote 
node.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is optional but 
recommended.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload<o:p></o:p></SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A 32-bit integer representing the current 
UNIX time, or time(NULL).</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.</SPAN></P>
<H2><A name=_Toc36413006><SPAN lang=EN-AU>/QA/D – Done Hub</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>References a hub which has now been queried, 
and should not be queried again.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Send a /QA/D child for the local hub and 
each neighbouring hub, whether or not the hub was actually forwarded the 
query.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If a hub was not forwarded 
the query, it was still effectively searched as the QHT indicated it could not 
field a matching object.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Upon receiving a /QA/D child, add the hub to 
the cache, freshen its timestamp and mark it as queried in this search.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Do not query this node again for several 
minutes.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A network/node address followed by a 16-bit 
leaf count.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.</SPAN></P>
<H2><A name=_Toc36413007><SPAN lang=EN-AU>/QA/S – Search Hub</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>References a hub which was not searched in 
this operation, but could be searched later if it has not already been 
touched.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Send a /QA/S child for every unique hub in 
the local hub cluster which is not a direct neighbour.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Optionally select some recent cached 
hubs and send /QA/S children for them also, to make up at least 10 in 
total.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Upon receiving a /QA/S child, add the hub to 
the cache and/or freshen its timestamp.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A network/node address, optionally followed 
by a 32-bit last-seen timestamp.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>This makes detecting the address family slightly harder, but the 
compactness is worthwhile.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>Timestamps are omitted for hubs in the local hub cluster, which should 
make up the majority.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.</SPAN></P>
<H2><A name=_Toc36413008><SPAN lang=EN-AU>/QA/RA – Retry After</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Advises the search client that the hub does 
not wish to be contacted again for a specified period of time.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Queries earlier than this time may 
result in a longer-term ban.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Send this child, with or without executing 
the search if the hub’s resources are becoming saturated.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It provides an indirect means of flow 
control.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Upon receiving a /QA/RA child, record the 
retry after interval and do not send any requests to the hub until the period 
has expired.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A 16 bit or 32 bit integer specifying the 
delay in seconds until the hub may be contacted again.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.</SPAN></P>
<H2><A name=_Toc36413009><SPAN lang=EN-AU>/QA/FR – From Address</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is used when a query 
acknowledgement is forwarded from a proxy hub to a firewalled leaf node.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It advises the leaf of the original 
sender.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>When a hub receives a /QA packet for a 
search originated by one of its leaves, it should forward the /QA to the 
appropriate leaf after adding a /QA/FR child with the remote hub’s network 
address.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>If this child is present and the /QA packet 
was received via TCP from a local hub, the node address within should be used as 
the remote hub’s node address.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>This 
information is often reflected in the first /QA/D child, however this is not 
always present.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A network address which may omit the port 
number.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.</SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36413010><SPAN lang=EN-AU>Search Results</SPAN></A></H1></DIV>
<H2><A name=_Toc36413011><SPAN lang=EN-AU>Introduction</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Search results from Gnutella2 nodes are 
delivered in /QH2 query hit packets.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>Each query hit packet may contain a number of matching object 
descriptors, and a single query may result in many /QH2 packets from many 
nodes.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Search results may contain 
varying amounts of information depending on the capabilities of different nodes, 
and the interest advertised in the original query.</SPAN></P>
<H2><A name=_Toc36413012><SPAN lang=EN-AU>/QH2 – Query Hit</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The /QH2 Gnutella2 query hit packet contains 
one or more search result descriptors, along with information about the node 
generating the result set.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>A single 
node may generate several /QH2 packets in response to a /Q2 query.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Like all Gnutella2 packets, the /QH2 
packet is highly extensible.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Send a /QH2 packet when processing a /Q2 
query packet reveals one or more matching objects.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Query hits can be returned directly to 
the /Q2/UDP return address in the query, or routed back along the delivery 
chain.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Firewalled leaf nodes are 
advised to return /QH2 packets to their connected hub for dispatch, as the hub 
will be able to make a reliable delivery.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Upon receiving a /QH2 query hit packet, 
check the query GUID against locally initiated queries.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>If it originated elsewhere, increment 
the route-back hop counter and forward it to the most appropriate link or UDP 
endpoint.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If it matches a locally 
generated query, process the search results.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A single byte representing the hop count, 
followed by a 16 byte GUID identifying the search that produced these 
results.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has many child packet types 
defined at the current time:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l39 level1 lfo42"><SPAN lang=EN-AU>H 
  – Hit Descriptor</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l39 level1 lfo42"><SPAN lang=EN-AU>HG 
  – Hit Group Descriptor</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l39 level1 lfo42"><SPAN lang=EN-AU>GU 
  – Node GUID</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l39 level1 lfo42"><SPAN lang=EN-AU>NA 
  – Node Address</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l39 level1 lfo42"><SPAN lang=EN-AU>NH 
  – Neighbouring Hub</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l39 level1 lfo42"><SPAN lang=EN-AU>V 
  – Vendor Code</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l39 level1 lfo42"><SPAN lang=EN-AU>MD 
  – Unified </SPAN><st2:PersonName><st1:GivenName><SPAN 
  lang=EN-AU>Metadata</SPAN></st1:GivenName><SPAN lang=EN-AU> 
  </SPAN><st1:Sn><SPAN lang=EN-AU>Block</SPAN></st1:Sn></st2:PersonName> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l39 level1 lfo42"><SPAN 
  lang=EN-AU>UPRO – User Profile</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l39 level1 lfo42"><SPAN 
  lang=EN-AU>BUP – Browse User Profile Tag</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l39 level1 lfo42"><SPAN 
  lang=EN-AU>PCH – Peer Chat Tag</SPAN> </LI></UL>
<H2><A name=_Toc36413013><SPAN lang=EN-AU>/QH2/GU – Node GUID</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Specifies the GUID of the sending 
node.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is required.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The GUID of the sending now.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.</SPAN></P>
<H2><A name=_Toc36413014><SPAN lang=EN-AU>/QH2/NA – Node Address</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Specifies the node / network address of the 
sending node.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is optional but 
recommended.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The node / network address of the sending 
node.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>See datatypes for more 
information.<o:p></o:p></SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.</SPAN></P>
<H2><A name=_Toc36413015><SPAN lang=EN-AU>/QH2/NH – Neighbouring 
Hub</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Lists a hub to which the sending node (a 
leaf) is connected.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>This provides a 
contact point for routing communications to a possibly firewalled leaf 
node.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is optional, and may appear more 
than once.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The node / network address of a hub to which 
the sending node is connected.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.</SPAN></P>
<H2><A name=_Toc36413016><SPAN lang=EN-AU>/QH2/V – Vendor Code</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Identifies the software operating the 
sending node.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is optional.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A four character vendor code.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.</SPAN></P>
<H2><A name=_Toc36413017><SPAN lang=EN-AU>/QH2/BUP – Browse User Profile 
Tag</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Indicates that the sending node supports 
browsing the local user profile.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is optional.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>No payload is defined at the current 
time.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.</SPAN></P>
<H2><A name=_Toc36413018><SPAN lang=EN-AU>/QH2/PCH – Peer Chat 
Tag</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Indicates that the sending node supports 
person to person private message chat.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is optional.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>No payload is defined at the current 
time.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.</SPAN></P>
<H2><A name=_Toc36413019><SPAN lang=EN-AU>/QH2/HG – Hit Group 
Descriptor</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Describes a group of search 
results.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is optional and may appear more 
than once.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A single byte, the group ID 
number.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has one child packet type 
currently defined:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l50 level1 lfo43"><SPAN lang=EN-AU>SS 
  – </SPAN><st2:place><st2:PlaceName><SPAN 
  lang=EN-AU>Server</SPAN></st2:PlaceName><SPAN lang=EN-AU> 
  </SPAN><st2:PlaceType><SPAN 
  lang=EN-AU>State</SPAN></st2:PlaceType></st2:place> </LI></UL>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36413020><SPAN lang=EN-AU>/QH2/HG/SS – 
</SPAN></A><st2:place><st2:PlaceName><SPAN 
style="mso-bookmark: _Toc36413020"><SPAN 
lang=EN-AU>Server</SPAN></SPAN></st2:PlaceName><SPAN 
style="mso-bookmark: _Toc36413020"><SPAN lang=EN-AU> 
</SPAN></SPAN><st2:PlaceType><SPAN style="mso-bookmark: _Toc36413020"><SPAN 
lang=EN-AU>State</SPAN></SPAN></st2:PlaceType></st2:place></H1></DIV>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Provides a status snapshot of the upload 
server that applies to search results in the current hit group.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Add this child to the hit group descriptor 
to provide server state information.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Use this information when interpreting hits 
linked with this hit group.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l50 level1 lfo43"><SPAN lang=EN-AU>A 
  16-bit integer : the current queue length including any active transfers 
  (number waiting plus number transferring)</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l50 level1 lfo43"><SPAN lang=EN-AU>An 
  8-bit integer : the maximum number of concurrent transfers (capacity)</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l50 level1 lfo43"><SPAN lang=EN-AU>A 
  32-bit integer : the speed in kilobits per second for uploads on this server 
  module</SPAN> </LI></UL>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.</SPAN></P>
<H2><A name=_Toc36413021><SPAN lang=EN-AU>/QH2/H – Hit 
Descriptor</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Describes a single object which matched the 
original query.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Send a /QH2/H child for each matching object 
to be included in this /QH2 packet.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>No payload is defined at the current 
time.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has many child packet types 
defined at the current time, and is often extended:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l13 level1 lfo44"><SPAN 
  lang=EN-AU>URN – Universal Resource Name</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l13 level1 lfo44"><SPAN 
  lang=EN-AU>URL – Universal Resource Location</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l13 level1 lfo44"><SPAN lang=EN-AU>DN 
  – Descriptive Name</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l13 level1 lfo44"><SPAN lang=EN-AU>MD 
  – Metadata</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l13 level1 lfo44"><SPAN lang=EN-AU>SZ 
  – Object Size</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l13 level1 lfo44"><SPAN lang=EN-AU>G 
  – Group Identifier</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l13 level1 lfo44"><SPAN lang=EN-AU>ID 
  – Object Identifier</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l13 level1 lfo44"><SPAN 
  lang=EN-AU>CSC – Cached Source Count</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l13 level1 lfo44"><SPAN 
  lang=EN-AU>PART – Partial Availability Marker</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l13 level1 lfo44"><SPAN 
  lang=EN-AU>COM – User Comment</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l13 level1 lfo44"><SPAN 
  lang=EN-AU>PVU – Preview URL</SPAN> </LI></UL>
<H2><A name=_Toc36413022><SPAN lang=EN-AU>/QH2/H/URN – Universal Resource 
Name</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Specifies a universal resource name which 
can be used to identify the object.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>At least one instance of this child is 
required.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Multiple instances are 
optional.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A string identifying the URN families 
followed by the URN in either text or binary representation.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Text representations should always be 
8-bit so that they can be considered binary.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The following compact URN families are 
recognised:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l57 level1 lfo37"><B 
  style="mso-bidi-font-weight: normal"><SPAN lang=EN-AU>bitprint</SPAN></B><SPAN 
  lang=EN-AU> or <B style="mso-bidi-font-weight: normal">bp</B> – 20 bytes of 
  SHA1 followed by 24 bytes of tiger-tree root</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l57 level1 lfo37"><B 
  style="mso-bidi-font-weight: normal"><SPAN lang=EN-AU>sha1</SPAN></B><SPAN 
  lang=EN-AU> – 20 bytes of SHA1</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l57 level1 lfo37"><B 
  style="mso-bidi-font-weight: normal"><SPAN 
  lang=EN-AU>tree:tiger/</SPAN></B><SPAN lang=EN-AU> or <B 
  style="mso-bidi-font-weight: normal">ttr</B> – 24 bytes of tiger-tree 
  root</SPAN> </LI></UL>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l12 level1 lfo1"><B 
  style="mso-bidi-font-weight: normal"><SPAN lang=EN-AU>md5</SPAN></B><SPAN 
  lang=EN-AU> – 16 bytes of MD5<B 
  style="mso-bidi-font-weight: normal"><o:p></o:p></B></SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l12 level1 lfo1"><B 
  style="mso-bidi-font-weight: normal"><SPAN lang=EN-AU>ed2k</SPAN></B><SPAN 
  lang=EN-AU> – 16 bytes of compound MD4 (ed2k style root hash)<B 
  style="mso-bidi-font-weight: normal"><o:p></o:p></B></SPAN> </LI></UL>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.</SPAN></P>
<H2><A name=_Toc36413023><SPAN lang=EN-AU>/QH2/H/URL – Universal Resource 
Location</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child specifies a location where the 
object being described can be acquired.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child should be sent if it was 
requested and a URL is available.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>If a /QH2/H/URL child was requested but is 
not present, the sending node may not have the object.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It is legal to advertise information 
about objects that are not available.<o:p></o:p></SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Empty, or a string which represents an 
absolute URL.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>If a URL is provided, that URL should be 
considered to point to an instance of the object being described.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>If the payload is empty, the sender is 
indicating that it has the object available locally.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It can be retrieved with an HTTP request 
using the “<SPAN class=SpellE>uri</SPAN>-res” resolver.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.</SPAN></P>
<H2><A name=_Toc36413024><SPAN lang=EN-AU>/QH2/H/DN – Descriptive Name (Generic) 
Criteria</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>The descriptive name for the object, and the 
object’s size.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child should be sent if it was 
requested and is available.<o:p></o:p></SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A 32-bit integer indicating the object’s 
size, followed by a string describing it.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>If a /QH2/H/SZ child is present, the 32-bit size prefix is omitted 
here.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36413025><SPAN lang=EN-AU>/QH2/H/MD – Metadata</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Provides metadata describing the 
object.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This chid should be sent if it was requested 
and is available.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A string containing XML.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>The &lt;?xml?&gt; header is 
optional.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Standard plural/singular 
Gnutella metadata schemas are used, for example:</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;?xml version=”1.0”?&gt;</SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;applications 
xsi:noNamespaceSchemaLocation=”<A 
href="http://www.shareaza.com/schemas/application.xsd">http://www.shareaza.com/schemas/application.xsd</A>”&gt;</SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;application title=”Shareaza”/&gt;</SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;/applications&gt;</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36413026><SPAN lang=EN-AU>/QH2/H/SZ – Object 
Size</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Specifies the size of the object.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child should be sent if DN was 
requested, and if the size is not to be packed into the /QH2/H/DN 
child.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A 32-bit or 64-bit integer representing the 
object size.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36413027><SPAN lang=EN-AU>/QH2/H/G – Group 
Identifier</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Indicates which hit group (/QH2/HG) this hit 
belongs to.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>If this child is not 
present, the hit belongs to group zero.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Send this child if this hit belongs to a hit 
group other than group zero.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>If this child is present, the hit belongs to 
a hit group other than group zero.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A single byte, the hit group ID.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36413028><SPAN lang=EN-AU>/QH2/H/ID – Object 
Identifier</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Specifies a 32-bit integer which uniquely 
identifies the object on the sender’s system.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is not normally sent for search 
results.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>It is used in browse-user 
responses to allow objects to be referenced by virtual folder 
structures.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Use this ID to link objects to virtual 
folder structures.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A 32-bit integer ID.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36413029><SPAN lang=EN-AU>/QH2/H/CSC – Cached Source 
Count</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Indicates the number of external cached 
sources known to the sending node</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is sent if cached sources are 
available and interest in URLs was expressed in the query.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A 16-bit integer.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36413030><SPAN lang=EN-AU>/QH2/H/PART – Partial Content 
Tag</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Indicates that the sending node has only 
part of the object, and how much it has.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is sent if a /QH2/H/URL child is 
present and the URL contains only part of the object.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A 32-bit integer, the number of bytes 
available.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36413031><SPAN lang=EN-AU>/QH2/H/COM – User 
Comment</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Provides a user review and/or rating for the 
object.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is sent if a user comment is 
available, and comments were requested.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>An XML string, of the form:</SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;comment rating=”n”&gt;</SPAN></P>
<P class=Code><SPAN lang=EN-AU>Text</SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;/comment&gt;</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The rating is an integer 0 &lt;= rating 
&lt;= 5, indicating the number of “stars”.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>The text may not include HTML, but may include forum-style block codes 
and emoticon notation.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36413032><SPAN lang=EN-AU>/QH2/H/PVU – Preview 
URL</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Indicates that a preview URL is available 
for the object.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>A preview URL will 
serve a miniature version of the content.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This child is sent if a preview is 
available.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Empty, or an absolute 
URL.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>If a URL is provided, that URL should be 
considered to point to a preview of the object being described.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>If the payload is empty, the sender is 
indicating that it has a preview of the object available locally.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>It can be retrieved with an HTTP request 
to the path:</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>/gnutella/preview/v1?urn:xyz</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36413033><SPAN lang=EN-AU>/QH2/MD – Unified 
</SPAN></A><st2:PersonName><st1:GivenName><SPAN 
style="mso-bookmark: _Toc36413033"><SPAN 
lang=EN-AU>Metadata</SPAN></SPAN></st1:GivenName><SPAN 
style="mso-bookmark: _Toc36413033"><SPAN lang=EN-AU> </SPAN></SPAN><st1:Sn><SPAN 
style="mso-bookmark: _Toc36413033"><SPAN 
lang=EN-AU>Block</SPAN></SPAN></st1:Sn></st2:PersonName></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Provides metadata describing one or more 
objects in the packet.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>This is an 
alternative method of delivering metadata, which allows metadata for similar 
objects to be grouped together.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>It 
is compatible with the unified metadata block format in Gnutella1.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This chid should be sent if it was requested 
and is available.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A string containing one or more XML 
documents, each beginning with a &lt;?xml?&gt; header.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Standard plural/singular Gnutella 
metadata schemas are used, for example:</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;?xml version=”1.0”?&gt;</SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;applications 
xsi:noNamespaceSchemaLocation=”<A 
href="http://www.shareaza.com/schemas/application.xsd">http://www.shareaza.com/schemas/application.xsd</A>”&gt;</SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;application index=”0” 
title=”Shareaza”/&gt;</SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;/applications&gt;</SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;?xml version=”1.0”?&gt;</SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;images xsi:noNamespaceSchemaLocation=”<A 
href="http://www.shareaza.com/schemas/image.xsd">http://www.shareaza.com/schemas/image.xsd</A>”&gt;</SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;image index=”1” description=”Shareaza Logo” 
width=”128” height=”128”/&gt;</SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;image index=”2” description=”Shareaza Screen 
Shot” width=”1024” height=”768”/&gt;</SPAN></P>
<P class=Code><SPAN lang=EN-AU>&lt;/images&gt;</SPAN></P>
<P class=Code><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>An additional attribute, “index” is added to 
each singular entry.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>The index is a 
zero-based integer identifying the Nth /QH2/H child within this /QH2 
packet.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36413034><SPAN lang=EN-AU>/QH2/UPRO – User 
Profile</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Delivers a user profile or user profile 
summary, describing the user operating the sending node.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Send a version of this child if the 
operating user wishes to list their screen name in search results.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>The current version of this packet contains 
a summary only, consisting of the screen/nick name.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Future versions may include a more 
comprehensive XML text block in the payload.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>No payload is defined at the current 
time.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>One child packet type is defined at the 
current time:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l38 level1 lfo45"><st1:GivenName><SPAN 
  lang=EN-AU>NICK</SPAN></st1:GivenName><SPAN lang=EN-AU> – Nick/screen 
  Name</SPAN> </LI></UL>
<H2><A name=_Toc36413035><SPAN lang=EN-AU>/QH2/UPRO/NICK – Nick/Screen 
Name</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Specifies the nick/screen name of the 
user.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>A string.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36413036><SPAN lang=EN-AU>Simple Query Language and 
Metadata</SPAN></A></H1></DIV>
<H2><A name=_Toc36413037><SPAN lang=EN-AU>Introduction</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>An effective search system must provide a 
query language which is:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l38 level1 lfo45"><SPAN 
  lang=EN-AU>Powerful</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l38 level1 lfo45"><SPAN 
  lang=EN-AU>Intuitive, and</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l38 level1 lfo45"><SPAN 
  lang=EN-AU>Natural</SPAN> </LI></UL>
<P class=MsoNormal><SPAN lang=EN-AU>At the same time, it is desirable for the 
language to be reasonably easy to parse in software.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>Gnutella2 employs a simple query language 
that is familiar to users of web search engines and allows most common criteria 
to be entered intuitively.</SPAN></P>
<H2><A name=_Toc36413038><SPAN lang=EN-AU>Query Language 
Definition</SPAN></A></H2>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l30 level1 lfo47"><SPAN 
  lang=EN-AU>Every search string is considered a list of words.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l30 level1 lfo47"><SPAN 
  lang=EN-AU>Words are identified as sequences of alphanumeric characters.<SPAN 
  style="mso-spacerun: yes">&nbsp; </SPAN>Other symbols and white space are 
  ignored.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l30 level1 lfo47"><SPAN lang=EN-AU>In 
  the basic case, every word in the list must appear one or more times in a 
  matching string.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l30 level1 lfo47"><SPAN 
  lang=EN-AU>Words may be marked as negative words or excluded words by 
  prefixing them with a dash (-).</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l30 level1 lfo47"><SPAN lang=EN-AU>In 
  this case, every positive word in the list must appear and every negative word 
  must not appear in a matching string.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l30 level1 lfo47"><SPAN 
  lang=EN-AU>Words can be grouped together with quotes.<SPAN 
  style="mso-spacerun: yes">&nbsp; </SPAN>The negation operator (-) may not 
  appear inside a quoted string, but it may prefix a quoted string in which case 
  the negation is applied to the quoted string as a whole.</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l30 level1 lfo47"><SPAN 
  lang=EN-AU>The words in a quoted string must appear in the same order in a 
  matching string.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Conversely, the 
  words in a negated quoted string must not appear or must not appear in the 
  same order in a matching string.</SPAN> </LI></UL>
<H2><A name=_Toc36413039><SPAN lang=EN-AU>Examples</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Cat Dog</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>(matches strings with “cat” and “dog”, in 
any order)</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>-Cat Dog</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>(matches strings with “dog” but not “cat”, 
in any order)</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>-Cat –Dog</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>(matches strings with neither “cat” nor 
“dog”, illegal in an external search as there are no positive words)</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>“cat dog”</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>(matches strings with “cat” followed by 
“dog”, “cat dog” matches, “dog cat” does not)</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>-“cat dog”</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>(matches strings without “cat dog”, “cat 
dog” does not match, “dog cat” does)</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>“cat dog” –fish</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>(matches strings with “cat dog” and without 
“fish”)</SPAN></P>
<H2><A name=_Toc36413040><SPAN lang=EN-AU>Metadata Searching</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Searching metadata involves a set of 
specific rules:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l47 level1 lfo48"><SPAN lang=EN-AU>If 
  a metadata schema is specified as search criteria, matching objects that have 
  metadata must share the same schema</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l47 level1 lfo48"><SPAN 
  lang=EN-AU>Metadata can only be compared if criteria and object share the same 
  schema</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l47 level1 lfo48"><SPAN 
  lang=EN-AU>Each data member (attribute or element) of metadata is compared 
  separately</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l47 level1 lfo48"><SPAN 
  lang=EN-AU>Where a member is specified in the criteria but not in the object, 
  the match fails</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l47 level1 lfo48"><SPAN 
  lang=EN-AU>Where a member is specified in the object but on in the criteria, 
  the member is ignored</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l47 level1 lfo48"><SPAN 
  lang=EN-AU>The search criteria for each text/string member is in the simple 
  query language defined above</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l47 level1 lfo48"><SPAN 
  lang=EN-AU>The search criteria for numeric members is range based, defined in 
  a subsequent section.</SPAN> </LI></UL>
<H2><A name=_Toc36413041></A><st2:place><st2:PlaceName><SPAN 
style="mso-bookmark: _Toc36413041"><SPAN 
lang=EN-AU>Numeric</SPAN></SPAN></st2:PlaceName><SPAN 
style="mso-bookmark: _Toc36413041"><SPAN lang=EN-AU> 
</SPAN></SPAN><st2:PlaceType><SPAN style="mso-bookmark: _Toc36413041"><SPAN 
lang=EN-AU>Range</SPAN></SPAN></st2:PlaceType></st2:place><SPAN 
style="mso-bookmark: _Toc36413041"><SPAN lang=EN-AU> Matching</SPAN></SPAN></H2>
<P class=MsoNormal><SPAN lang=EN-AU>When comparing numeric values, the match 
function is specified by the search criteria:</SPAN></P>
<UL style="MARGIN-TOP: 0cm" type=disc>
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l41 level1 lfo49"><SPAN lang=EN-AU>If 
  a value is specified, the value must match exactly</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l41 level1 lfo49"><SPAN lang=EN-AU>If 
  a range (X-Y) is specified, the value must lie within that inclusive 
  range</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l41 level1 lfo49"><SPAN lang=EN-AU>If 
  (X-) is specified, the value must be greater than or equal to X</SPAN> 
  <LI class=MsoNormal 
  style="tab-stops: list 36.0pt; mso-list: l41 level1 lfo49"><SPAN lang=EN-AU>If 
  (-X) is specified, the value must be less than or equal to X</SPAN> </LI></UL>
<H2><A name=_Toc36413042><SPAN lang=EN-AU>Generic Matching on 
Metadata</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Generic search criteria (/Q2/DN) can be 
matched against metadata fields, however care must be taken not to match against 
data members which are not directly descriptive to the object.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>Client-side schema descriptors are a 
good solution, listing the scope of a general search on each recognised 
schema.<o:p></o:p></SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36413043><SPAN lang=EN-AU>HTTP/1.1 Server for 
Uploading</SPAN></A></H1></DIV>
<P class=MsoNormal><SPAN lang=EN-AU>This is not a core part of the Gnutella2 
architecture, and is discussed in depth elsewhere.<o:p></o:p></SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36413044><SPAN lang=EN-AU>HTTP/1.1 Client for 
Downloading</SPAN></A></H1></DIV>
<P class=MsoNormal><SPAN lang=EN-AU>This is not a core part of the Gnutella2 
architecture, and is discussed in depth elsewhere.<o:p></o:p></SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><A name=_Toc36413045><SPAN lang=EN-AU>User Profile Challenge and 
Delivery</SPAN></A><SPAN lang=EN-AU><o:p></o:p></SPAN></H1></DIV>
<H2><A name=_Toc36413046><SPAN lang=EN-AU>Introduction</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Community is an important part of a peer to 
peer experience, and a unified user profile format enables meaningful exchange 
of user metadata.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Gnutella user 
profiles are XML documents adhering to a user profile schema referenced 
below.</SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU>User profile information is exchanged at 
strategic points in network communications, using packet types defined in 
subsequent sections.</SPAN></P>
<H2><A name=_Toc36413047><SPAN lang=EN-AU>gProfile Schema</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>To be copied in.</SPAN></P>
<H2><A name=_Toc36413048><SPAN lang=EN-AU>Profile Challenge and 
Response/Delivery</SPAN></A></H2>
<P class=MsoNormal><SPAN lang=EN-AU>Requesting a user profile from another user 
involves a challenge and response transaction.<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>The challenge step allows the initiator 
to provide a random token for the respondent to sign with a digital signature 
and return, verifying its identity.<SPAN style="mso-spacerun: yes">&nbsp; 
</SPAN>This allows a distributed identity safeguard, which is under 
development.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36413049><SPAN lang=EN-AU>/UPROC – User Profile 
Challenge</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Requests the user profile of a 
node.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Send this packet to request the user profile 
of another node.</SPAN></P>
<H3><SPAN lang=EN-AU>Receiving</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Upon receiving this packet, respond with a 
user profile if one is available.</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>No payload is defined at the current 
time.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<H2><A name=_Toc36413050><SPAN lang=EN-AU>/UPROD – User Profile 
Delivery</SPAN></A></H2>
<H3><SPAN lang=EN-AU>Overview</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Delivers a user profile.</SPAN></P>
<H3><SPAN lang=EN-AU>Sending</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>Send this packet in response to a user 
profile challenge (/UPROC)</SPAN></P>
<H3><SPAN lang=EN-AU>Payload</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>An XML string, adhering to the Gnutella user 
profile schema.</SPAN></P>
<H3><SPAN lang=EN-AU>Children</SPAN></H3>
<P class=MsoNormal><SPAN lang=EN-AU>This packet has no known children at the 
current time.<o:p></o:p></SPAN></P>
<DIV 
style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: #6699ff 1.5pt solid">
<H1><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></H1></DIV>
<P class=MsoNormal><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=EN-AU><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><st2:PersonName><st1:GivenName><SPAN 
lang=EN-AU>Michael</SPAN></st1:GivenName><SPAN lang=EN-AU> </SPAN><st1:Sn><SPAN 
lang=EN-AU>Stokes</SPAN></st1:Sn></st2:PersonName></P>
<P class=MsoNormal><SPAN lang=EN-AU>© Shareaza Pty. Ltd.</SPAN></P>
<P class=MsoNormal><SPAN 
lang=EN-AU>2003-03-26<o:p></o:p></SPAN></P></DIV></BODY></HTML>
<!--//--><script>if(document.layers){document.captureEvents(Event.MOUSEUP);}document.onmouseup=PrxOMUp;</script>
